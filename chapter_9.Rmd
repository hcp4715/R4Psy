---
title: ""
author: "Pac_B"
date: ""
output:
  xaringan::moon_reader:
    css: [default, css/Custumed_Style.css,css/zh-CN.css]
    lib_dir: libs
    nature:
      highlightLines: true
      highlightStyle: github
      countIncrementalSlides: false
      seal: true
      ratio: 16:9
params:
  output_dir: "../output"
---

class: center, middle
<span style="font-size: 50px;">**ç¬¬ä¹ç« **</span> <br>
<span style="font-size: 50px;">å›å½’æ¨¡å‹(ä¸€)</span> <br>
<span style="font-size: 30px;">èƒ¡ä¼ é¹</span> <br>
<span style="font-size: 20px;"> </span> <br>
<span style="font-size: 30px;">`r Sys.Date()`</span> <br>
<span style="font-size: 20px;"> Made with Rmarkdown</span> <br>

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = F
)
```

```{css extra.css, echo=FALSE}
/* ---- extra.css ---- */
.bigfont {
  font-size: 30px;
}
.size5{
font-size: 20px;
}
.tit_font{
font-size: 60px;
}

```

```{r xaringan-panelset, echo=FALSE}
xaringanExtra::use_panelset()
```

```{r, echo=FALSE}
# Packages
if (!requireNamespace('pacman', quietly = TRUE)) {
    install.packages('pacman')
}

pacman::p_load(
  # æœ¬èŠ‚è¯¾éœ€è¦ç”¨åˆ°çš„ packages
  here, tidyverse, bruceR, DT, car,
  # ç”Ÿæˆè¯¾ä»¶
  xaringan, xaringanthemer, xaringanExtra)
```

```{r, echo=FALSE}
# æ”¹å˜Råœ¨æ˜¾ç¤ºå¤§æ•°å­—å’Œå°æ•°å­—æ—¶æ˜¯é€‰æ‹©å¸¸è§„æ ¼å¼è¿˜æ˜¯ç§‘å­¦è®¡æ•°æ³•çš„å€¾å‘
options(scipen=999)

# è¿˜åŸè®¾ç½® options(scipen = 0)
```

---
<h1 lang="zh-CN" style="font-size: 60px;"> </h1>
<br>
<br>
## çº¯ç²¹çš„Rä»£ç å­¦ä¹  â†’ ä½¿ç”¨Rè¯­è¨€æ¥å®ç°**ç»Ÿè®¡çŸ¥è¯†** <br>
<br>
## (1) R: æ›´çµæ´»çš„ç»Ÿè®¡åˆ†ææ–¹æ³•ï¼Œä¸ç»Ÿè®¡çŸ¥è¯†ç»“åˆæ›´åŠ ç´§å¯†<br>
<br>
## (2) å¿ƒç†å­¦/ç¤¾ä¼šç§‘å­¦ä¸­å¸¸ç”¨çš„ç»Ÿè®¡æ£€éªŒå‡æ˜¯å›å½’æ¨¡å‹<br>

---
<h1 lang="zh-CN" style="font-size: 60px;">ç ”ç©¶é—®é¢˜</h1>

<br>
## åœ¨Human Penguin Projectæ•°æ®ä¸­ï¼Œç¬¬ä¸€æ¬¡ä½“æ¸©èƒ½å¦é¢„æµ‹ç¬¬äºŒæ¬¡ä½“æ¸©ï¼Ÿ
<br>

<br>
## åœ¨Human Penguin Projectæ•°æ®ä¸­ï¼Œä¸åŒæ‹çˆ±çŠ¶æ€(romantic)ä¸‹è¢«è¯•æ ¸å¿ƒä½“æ¸©(Temperature)æ˜¯å¦æœ‰å·®å¼‚ï¼Ÿ
<br>
<br>
## åœ¨Human Penguin Projectæ•°æ®ä¸­ï¼Œä¸åŒè·èµ¤é“è·ç¦»(DEQ)å’Œæ‹çˆ±çŠ¶æ€(romantic)æ¡ä»¶ä¸‹è¢«è¯•æ ¸å¿ƒä½“æ¸©(Temperature)æ˜¯å¦æœ‰å·®å¼‚ï¼Ÿ
<br>
<br>

---
<h1 lang="en" style="font-size: 60px;">Contents</h1>
<br>
<span style="font-size: 35px;">8.0 ç®€å•çº¿æ€§å›å½’</span></center> <br>
<span style="font-size: 20px;">&emsp;8.0.1 çº¿æ€§å›å½’æ¨¡å‹å›é¡¾</span></center> <br>
<span style="font-size: 20px;">&emsp;8.0.2 çº¿æ€§å›å½’åœ¨Rä¸­çš„å®ç°</span></center> <br>
<span style="font-size: 20px;">&emsp;8.0.3 bruceR::regress</span></center> <br>
<br>
<span style="font-size: 35px;">8.1 *t*-test & linear regression</span></center> <br>
<span style="font-size: 20px;">&emsp;8.1.1 ç‹¬ç«‹æ ·æœ¬*t*æ£€éªŒ</span></center> <br>
<span style="font-size: 20px;">&emsp;8.1.2 çº¿æ€§å›å½’çš„è¡¨è¾¾</span></center> <br>
<span style="font-size: 20px;">&emsp;8.1.3 å•æ ·æœ¬*t*æ£€éªŒ</span></center> <br>
<span style="font-size: 20px;">&emsp;8.1.4 é…å¯¹æ ·æœ¬*t*æ£€éªŒ</span></center> <br>
<span style="font-size: 20px;">&emsp;8.1.5 bruceR::TTEST</span></center> <br>
<br>
<span style="font-size: 35px;">8.2 ANOVA & linear regression</span></center> <br>
<span style="font-size: 20px;">&emsp;8.2.1 ç ”ç©¶é—®é¢˜</span></center> <br>
<span style="font-size: 20px;">&emsp;8.2.2 ä»£ç å®æ“</span></center> <br>
<span style="font-size: 20px;">&emsp;8.2.3 çº¿æ€§å›å½’çš„è¡¨è¾¾</span></center> <br>
<span style="font-size: 20px;">&emsp;8.2.4 çŸ¥è¯†å»¶ç”³</span></center> <br>


---
class: center, middle
<span style="font-size: 60px;">8.1 *t*-test & linear regression</span> <br>

---
class: left, middle
<span style="font-size: 60px;">8.0 çº¿æ€§å›å½’å›é¡¾</span> <br>

<br>
<span style="font-size: 35px;">Q: ç¬¬ä¸€æ¬¡ä½“æ¸©æµ‹é‡æ˜¯å¦ä¸ç¬¬äºŒä½“æ¸©æµ‹é‡çš„å…³ç³»ï¼Ÿ</span> <br>
<br>
<span style="font-size: 40px;">A: ç®€å•çº¿æ€§å›å½’</span> <br>

---

## çº¿æ€§å›å½’è¡¨è¾¾å¼

</br>

$y = a + bX + \epsilon$

</br>

-   y -- Data

-   a+bX -- model

-   $\epsilon$ -- error

---

## çº¿æ€§å›å½’è¡¨è¾¾å¼
<span style="font-size: 30px;">
</br>

$$y = a + bX + \epsilon$$

-   y -- å› å˜é‡ï¼ŒDependent variable

-   x -- è‡ªå˜é‡ï¼ŒIndependent (explanatory) variable

-   a -- æˆªè·ï¼ŒIntercept

-   b -- æ–œç‡ï¼ŒSlope

-   $\epsilon$ -- æ®‹å·®ï¼ŒResidual (error)
</span>
---
## çº¿æ€§å›å½’è¡¨è¾¾å¼

</br>

$$y_i = a + bx_i + \epsilon $$

$$\downarrow$$

$$Y_1 = \alpha + \beta_1 X_1 + \epsilon_1$$

$$Y_2=\alpha + \beta_1 X_2 + \epsilon_2$$

$$...$$

$$Y_n = \alpha + \beta_1 X_n + \epsilon_n$$
---
## çŸ©é˜µè¡¨è¾¾

$$Y_{nÃ—1} =X_{nÃ—2} \beta_{2Ã—1} + \epsilon_{nÃ—1}$$

$$Y = X \beta + \epsilon$$

<div style="column-count: 4;">
$$Y_{nÃ—1}=\begin{bmatrix}
  y_1 \\
  y_2 \\
  ... \\
  y_n
\end{bmatrix}$$

$$X_{nÃ—2}=\begin{bmatrix}
  1&x_{12} \\
  1&x_{22} \\
  ...&... \\
  1&x_{n2}
\end{bmatrix}$$

$$\beta_{2Ã—1}=\begin{bmatrix}
 \alpha\\
 \beta_1
\end{bmatrix}$$

$$\epsilon_{nÃ—1}=\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  ...\\
  \epsilon_n
  \end{bmatrix}$$
</div>

---
## ä»£ç è¡¨è¾¾(`r`)

</br>

"Formula = Y ~ X"

</br>

- $Y$: å› å˜é‡ 
- $X$: è‡ªå˜é‡

---
# 8.0 çº¿æ€§å›å½’å›é¡¾
## 8.0.2 ä¸€ä¸ªç®€å•çš„çº¿æ€§å›å½’çš„Rä»£ç 

.panelset[
.panel[.panel-name[åŸºç¡€çŸ¥è¯†]

<br>
**Xæ˜¯å¦èƒ½å¤Ÿâ€œé¢„æµ‹â€Y**
<br>
**å‰ææ¡ä»¶**
1.  æ¨¡å‹è®¾å®šå‡å®š(çº¿æ€§é¢„è®¾);

2.  æ­£äº¤é¢„è®¾(è¯¯å·®é¡¹ğå’Œxä¸ç›¸å…³; è¯¯å·®é¡¹ğçš„æœŸæœ›å€¼ä¸º0);

3.  æ®‹å·®æ–¹å·®é½æ€§é¢„è®¾;

4.  æ®‹å·®æ­£æ€åˆ†å¸ƒé¢„è®¾(æ®‹å·®é¡¹ğç‹¬ç«‹ä¸”åŒåˆ†å¸ƒ).<br>
<br>

**å‡è®¾**
* $H_0$: Xä¸èƒ½æ˜¾è‘—åœ°é¢„æµ‹Yï¼Œå³ $\beta$ = 0
* $H_1$: Xèƒ½æ˜¾è‘—åœ°é¢„æµ‹Yï¼Œå³ $\beta$ â‰  0
<br>

.panel[.panel-name[æ•°æ®æ¸…ç†]

```{r preprocessing for lm}
df.penguin <- bruceR::import(here::here('data', 'penguin', 'penguin_rawdata.csv')) %>%
  dplyr::mutate(subjID = row_number()) %>%
  dplyr::select(subjID,Temperature_t1, Temperature_t2) %>%         # é€‰æ‹©å˜é‡
  dplyr::filter(!is.na(Temperature_t1) & !is.na(Temperature_t2)) 
```

```{r, echo=FALSE}
DT::datatable(head(df.penguin),
              fillContainer = TRUE, options = list(pageLength = 4))
```

.panel[.panel-name[åˆæ­¥å¯è§†åŒ–]

```{r visualization for lm, fig.width=6, fig.height=4}
df.penguin %>%
      ggplot2::ggplot(aes(x = Temperature_t1, y = Temperature_t2)) +
      geom_point() +
      geom_smooth(method = "lm", se = TRUE) +
      theme_classic()
```

.panel[.panel-name[ä»£ç å®æ“]

```{r lm in stats}
m1 <- stats::lm(Temperature_t2 ~ Temperature_t1,  # å…¬å¼
          data = df.penguin,                # æ•°æ®æ¡†
          )

# ä½¿ç”¨ broom åŒ…çš„ glance() å‡½æ•°æ¥æå–æ¨¡å‹æ‘˜è¦ä¿¡æ¯
m1_summary <- broom::tidy(m1)

# ä½¿ç”¨ knitr åŒ…çš„ kable() å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ ¼å¼åŒ–çš„è¡¨æ ¼
knitr::kable(m1_summary, caption = "Model Summary")
```
.panel[.panel-name[bruceR::model_summary]


```{r summary using bruceR}
bruceR::model_summary(m1)
```
]
]
]
]
]
]
---
# 8.0 çº¿æ€§å›å½’å›é¡¾
## 8.0.3 bruceR::regress

```{r lm in bruceR}
m2 <- bruceR::regress(Temperature_t2 ~ Temperature_t1,  # å…¬å¼
          data = df.penguin) # æ•°æ®
```
---
class: left, middle
<span style="font-size: 60px;">8.1  *t*æ£€éªŒä½œä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹</span> <br>

```{r, echo = FALSE, fig.width = 3, fig.height = 2}
knitr::include_graphics('picture/chp8/IJzerman2018fig.png')
```
(å¼•è‡ª[IJzerman et al., 2018](https://doi.org/10.1525/collabra.165))

<br>
<span style="font-size: 35px;">Q: ä¸åŒæ‹çˆ±çŠ¶æ€(romantic)ä¸‹äººä»¬çš„æ ¸å¿ƒä½“æ¸©(Temperature)æ˜¯å¦æœ‰å·®å¼‚ï¼Ÿ</span> <br>
<br>
<span style="font-size: 40px;">A: ç‹¬ç«‹æ ·æœ¬*t*æ£€éªŒ</span> <br>

---
# 8.1 *t*-test
## 8.1.1 ç‹¬ç«‹æ ·æœ¬*t*æ£€éªŒ(independent *t*-test)

.panelset[
.panel[.panel-name[åŸºç¡€çŸ¥è¯†]

<br>
**æ¯”è¾ƒä¸¤ä¸ªç‹¬ç«‹æ ·æœ¬ç¾¤ä½“çš„å‡å€¼æ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚ã€‚**
<br>
**å‰ææ¡ä»¶**
* æ­£æ€æ€§ï¼šä¸¤ä¸ªæ ·æœ¬æ•°æ®éƒ½åº”è¯¥æ¥è‡ªæ­£æ€åˆ†å¸ƒçš„æ€»ä½“ã€‚æ ·æœ¬é‡è¶³å¤Ÿå¤§æ—¶ï¼Œå³ä½¿ä¸ä¸¥æ ¼æœä»æ­£æ€åˆ†å¸ƒï¼Œç»“æœä¹Ÿæ˜¯ç¨³å¥çš„ã€‚
* åŒæ–¹å·®æ€§ï¼šä¸¤ä¸ªæ ·æœ¬çš„æ–¹å·®åº”è¯¥æ˜¯ç›¸ç­‰çš„ã€‚
* ç‹¬ç«‹æ€§ï¼šä¸¤ä¸ªæ ·æœ¬åº”è¯¥æ˜¯ç‹¬ç«‹çš„ï¼Œå³ä¸€ä¸ªæ ·æœ¬çš„è§‚æµ‹å€¼ä¸åº”å½±å“å¦ä¸€ä¸ªæ ·æœ¬çš„è§‚æµ‹å€¼ã€‚<br>
<br>

**å‡è®¾**
* $H_0$: ä¸¤ä¸ªç‹¬ç«‹æ ·æœ¬ç¾¤ä½“çš„å‡å€¼æ²¡æœ‰æ˜¾è‘—å·®å¼‚ï¼Œå³ $Î¼_1$ = $Î¼_2$
* $H_1$: ä¸¤ä¸ªç‹¬ç«‹æ ·æœ¬ç¾¤ä½“çš„å‡å€¼æœ‰æ˜¾è‘—å·®å¼‚ï¼Œå³ $Î¼_1$ â‰  $Î¼_2$
<br>
$$t = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}$$

.panel[.panel-name[æ•°æ®æ¸…ç†]

```{r preprocessing}
df.penguin <- bruceR::import(here::here('data', 'penguin', 'penguin_rawdata.csv')) %>%
  dplyr::mutate(subjID = row_number()) %>%
  dplyr::select(subjID,Temperature_t1, Temperature_t2, socialdiversity, 
                Site, DEQ, romantic, ALEX1:ALEX16) %>%                                     # é€‰æ‹©å˜é‡
  dplyr::filter(!is.na(Temperature_t1) & !is.na(Temperature_t2) & !is.na(DEQ)) %>%         # å¤„ç†ç¼ºå¤±å€¼
  dplyr::mutate(romantic = factor(romantic, levels = c(1,2), labels = c("æ‹çˆ±", "å•èº«")),  # è½¬åŒ–ä¸ºå› å­
                Temperature = rowMeans(select(., starts_with("Temperature"))),             # è®¡ç®—ä¸¤æ¬¡æ ¸å¿ƒæ¸©åº¦çš„å‡å€¼
                ALEX4  = case_when(TRUE ~ 6 - ALEX4),
                ALEX12 = case_when(TRUE ~ 6 - ALEX12),
                ALEX14 = case_when(TRUE ~ 6 - ALEX14),
                ALEX16 = case_when(TRUE ~ 6 - ALEX16),
                ALEX   = rowSums(select(., starts_with("ALEX")))) # åå‘è®¡åˆ†åè®¡ç®—æ€»åˆ†
```

```{r, echo=FALSE}
DT::datatable(head(df.penguin),
              fillContainer = TRUE, options = list(pageLength = 4))
```

.panel[.panel-name[ä»£ç å®æ“]

```{r ttest in stats}
stats::t.test(data = df.penguin,      # æ•°æ®æ¡†
              Temperature ~ romantic, # å› å˜é‡~è‡ªå˜é‡
              var.equal = TRUE) %>%
  capture.output()                    # å°†è¾“å‡ºå˜æ•´é½
```


]]]]

---
# 8.1 *t*-testä½œä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.2 çº¿æ€§å›å½’(linear regression)
<br>
* ç‹¬ç«‹æ ·æœ¬*t*æ£€éªŒæ˜¯çº¿æ€§æ¨¡å‹çš„ç‰¹æ®Šå½¢å¼(è‡ªå˜é‡ä¸ºäºŒåˆ†å˜é‡ï¼‰
--
<p align="center">
  <img src="./picture/chp8/indet-lm.png" width="55%">
</p>


---
# 8.1 *t*-test & linear regression

.pull-left[
```{r ttest, results='hide'}
# tæ£€éªŒ
stats::t.test(data = df.penguin,
              Temperature ~ romantic,
              var.equal = TRUE) %>%
      capture.output()                    # å°†è¾“å‡ºå˜æ•´é½
```

<p align="center">
  <img src="./picture/chp8/compare1.1.png" width="100%">
</p>
]

.pull-right[
```{r ttest in lm,results='hide'}
# çº¿æ€§å›å½’
model.inde <- stats::lm(
  data = df.penguin,
  formula = Temperature ~ 1 + romantic
  )
summary(model.inde)
```

<p align="center">
  <img src="./picture/chp8/compare1.2.png" width="100%">
</p>

]


---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.3 å•æ ·æœ¬*t*æ£€éªŒ(one sample *t*-test)
* ä¾‹å¦‚ï¼šåœ¨penguinæ•°æ®ä¸­ï¼Œå…¨ä½“è¢«è¯•çš„æ ¸å¿ƒä½“æ¸©(Temperature)æ˜¯å¦ç­‰äº36.6ï¼Ÿ<br>
<br>
--
<br>
**æ¯”è¾ƒå•ä¸ªæ ·æœ¬çš„å¹³å‡å€¼(m)ä¸å·²çŸ¥çš„æ€»ä½“å¹³å‡å€¼(Î¼)ä¹‹é—´æ˜¯å¦å­˜åœ¨æ˜¾è‘—å·®å¼‚**<br>
<br>

**å‰ææ¡ä»¶**
* æ­£æ€æ€§ï¼šæ ·æœ¬æ•°æ®åº”æ¥è‡ªæ­£æ€åˆ†å¸ƒçš„æ€»ä½“ã€‚æ ·æœ¬é‡è¶³å¤Ÿå¤§æ—¶ï¼Œå³ä½¿ä¸ä¸¥æ ¼æœä»æ­£æ€åˆ†å¸ƒï¼Œç»“æœä¹Ÿæ˜¯ç¨³å¥çš„ã€‚
* ç‹¬ç«‹æ€§ï¼šæ ·æœ¬ä¸­çš„è§‚æµ‹å€¼å¿…é¡»æ˜¯ç‹¬ç«‹çš„ï¼Œå³ä¸€ä¸ªè§‚æµ‹å€¼ä¸åº”å½±å“å¦ä¸€ä¸ªè§‚æµ‹å€¼ã€‚<br>
<br>

**å‡è®¾**
* $H_0$: æ ·æœ¬çš„å‡å€¼(m)ä¸ç»™å®šçš„æ€»ä½“å‡å€¼æˆ–å‡è®¾çš„æ€»ä½“å‡å€¼(Î¼)ä¹‹é—´æ²¡æœ‰æ˜¾è‘—å·®å¼‚ã€‚
* $H_1$: æ ·æœ¬çš„å‡å€¼(m)ä¸ç»™å®šçš„æ€»ä½“å‡å€¼æˆ–å‡è®¾çš„æ€»ä½“å‡å€¼(Î¼)ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ã€‚
<br>

$$t = \frac{\bar{X} - \mu}{s / \sqrt{n}}$$

---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.3 å•æ ·æœ¬*t*æ£€éªŒ(one sample *t*-test)
.pull-left[
<br>
<br>

$$y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \epsilon$$

å•æ ·æœ¬*t*æ£€éªŒä¸­ï¼Œä»…æˆªè·ä¸ä¸º0ã€‚æ­¤æ—¶å…¬å¼ä¸ºï¼š<br>
--
$$y = \beta_0$$
$$H_0: \beta_0 = 0$$
]
.pull-right[
<p align="center">
  <img src="./picture/chp8/singlet-lm.png" width="75%">
</p>
]
---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.3 å•æ ·æœ¬*t*æ£€éªŒ(one sample *t*-test)

.pull-left[
```{r,results='hide'}
stats::t.test(
  x = df.penguin$Temperature, # æ ¸å¿ƒä½“æ¸©å‡å€¼
  mu = 36.6) 
  
```

<br>
<br>
<p align="center">
  <img src="./picture/chp8/compare2.1.png" width="100%">
</p>

]
.pull-right[
```{r,results='hide'}
model.single <- lm(
  data = df.penguin,
  formula = Temperature - 36.6 ~ 1
  ) 
summary(model.single) 
```

<br>
<br>
<p align="center">
  <img src="./picture/chp8/compare2.2.png" width="100%">
</p>

]

---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.4 é…å¯¹æ ·æœ¬*t*æ£€éªŒ(paired *t*-test)
* ä¾‹å¦‚ï¼Œåœ¨penguinæ•°æ®ä¸­ï¼Œè¢«è¯•æŠ¥å‘Šçš„ä¸¤æ¬¡æ ¸å¿ƒæ¸©åº¦(Temperature_t1, Temperature_t2)æ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚ï¼Ÿ<br>
<br>
--
**æ¯”è¾ƒä¸¤ä¸ªç›¸å…³çš„æ ·æœ¬ç»„ï¼ˆä¾‹å¦‚ï¼ŒåŒä¸€ç»„å—è¯•è€…åœ¨ä¸åŒæ¡ä»¶ä¸‹çš„æµ‹é‡ï¼‰çš„å¹³å‡å€¼æ˜¯å¦å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚**<br>
<br>
**å‰ææ¡ä»¶**
* æ­£æ€æ€§ï¼šæ ·æœ¬æ•°æ®åº”æ¥è‡ªæ­£æ€åˆ†å¸ƒçš„æ€»ä½“ã€‚æ ·æœ¬é‡è¶³å¤Ÿå¤§æ—¶ï¼Œå³ä½¿ä¸ä¸¥æ ¼æœä»æ­£æ€åˆ†å¸ƒï¼Œç»“æœä¹Ÿæ˜¯ç¨³å¥çš„ã€‚
* ç‹¬ç«‹æ€§ï¼šé…å¯¹æ ·æœ¬ä¸­çš„è§‚æµ‹å€¼å¿…é¡»æ˜¯ç‹¬ç«‹çš„ï¼Œå³æ¯ä¸€å¯¹è§‚æµ‹å€¼ä¸åº”å½±å“å…¶ä»–å¯¹çš„è§‚æµ‹å€¼ã€‚
* é…å¯¹è®¾è®¡ï¼šæ•°æ®å¿…é¡»æ˜¯ä»¥é…å¯¹å½¢å¼æ”¶é›†çš„ã€‚<br>
<br>
**å‡è®¾**
* $H_0$: é…å¯¹æ ·æœ¬çš„æ€»ä½“å¹³å‡å·®ä¸é›¶æ²¡æœ‰æ˜¾è‘—å·®å¼‚ï¼ˆä¸¤ä¸ªé…å¯¹æ ·æœ¬çš„å‡å€¼æ²¡æœ‰æ˜¾è‘—å·®å¼‚ï¼‰ã€‚
* $H_1$: é…å¯¹æ ·æœ¬çš„æ€»ä½“å¹³å‡å·®ä¸é›¶æœ‰æ˜¾è‘—å·®å¼‚ï¼ˆä¸¤ä¸ªé…å¯¹æ ·æœ¬çš„å‡å€¼å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼‰ã€‚
<br>

$$t = \frac{\bar{X} - \mu}{s / \sqrt{n}}$$
---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.4 é…å¯¹æ ·æœ¬*t*æ£€éªŒ(paired *t*-test)

$$y_1 - y_2 = \beta_0 $$
$$H_0: \beta_0 = 0 $$
--
å¯ä»¥å°†é…å¯¹æ ·æœ¬*t*æ£€éªŒç†è§£ä¸ºå¯¹å·®å€¼è¿›è¡Œçš„å•æ ·æœ¬*t*æ£€éªŒï¼Œå³å•ç‹¬ç”¨ä¸€ä¸ªæ•°å­—æ¥é¢„æµ‹å¯¹åº”çš„å·®å€¼ï¼ˆè§å›¾çš„å³åŠéƒ¨åˆ†ï¼‰ã€‚<br>
ä¹Ÿå¯ä»¥è®¤ä¸ºè¿™äº›ç»„é—´ä¹‹å·®æ˜¯æ–œç‡ï¼ˆè§å›¾çš„å·¦åŠéƒ¨åˆ†ï¼‰ã€‚<br>

<p align="center">
  <img src="./picture/chp8/pairt-lm.png" width="70%">
</p>

---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.4 é…å¯¹æ ·æœ¬*t*æ£€éªŒ(paired *t*-test)
.pull-left[

```{r,results='hide'}
stats::t.test(
  x = df.penguin$Temperature_t1, 
  y = df.penguin$Temperature_t2, 
  paired = TRUE
  )
```

<br>
<br>
<p align="center">
  <img src="./picture/chp8/compare3.1.png" width="100%">
</p>

]
.pull-right[

```{r,results='hide'}
model.paired <- lm(
  Temperature_t1 - Temperature_t2 ~ 1,
  data = df.penguin
  )
summary(model.paired)
```

<br>
<br>
<p align="center">
  <img src="./picture/chp8/compare3.2.png" width="100%">
</p>

]

---
# 8.1 *t*-test
## 8.1.5 bruceR::TTEST
* å¦‚æœåå¥½æŒ‰ä¼ ç»Ÿæ–¹å¼ä½¿ç”¨*t*æ£€éªŒï¼Œæ¨è`bruceR::TTEST`å‡½æ•°

<p align="center">
  <img src="./picture/chp8/TTEST.png" width="70%">
</p>

ä¸­æ–‡å¸®åŠ©æ–‡æ¡£ï¼šhttps://zhuanlan.zhihu.com/p/281150493
---
# 8.1 *t*-test
## 8.1.5 bruceR::TTEST
.panelset[
.panel[.panel-name[ç‹¬ç«‹æ ·æœ¬tæ£€éªŒ]
.pull-left[

```{r,results='hide'}
stats::t.test(
  data = df.penguin, 
  Temperature ~ romantic,
  var.equal = TRUE
  ) 
```


<br>
<p align="center">
  <img src="./picture/chp8/compare1.1.png" width="100%">
</p>
]
.pull-right[

```{r,results='hide'}
bruceR::TTEST(
  data = df.penguin, # æ•°æ®
  y = "Temperature", # å› å˜é‡
  x = "romantic"     # è‡ªå˜é‡
) 
```

<br>
<p align="center">
  <img src="./picture/chp8/leven.png" width="100%">
</p>


]
.panel[.panel-name[å•æ ·æœ¬tæ£€éªŒ]
.pull-left[

```{r, results='hide'}
stats::t.test(
  x = df.penguin$Temperature, 
  mu = 36.6
  )

```


<br>
<p align="center">
  <img src="./picture/chp8/compare2.1.png" width="100%">
</p>
]
.pull-right[

```{r,results='hide'}
bruceR::TTEST(
  data = df.penguin, # æ•°æ®
  y = "Temperature", # ç¡®å®šå˜é‡
  test.value = 36.6, # å›ºå®šå€¼
  test.sided = "=")  # å‡è®¾çš„æ–¹å‘

```

<br>
<p align="center">
  <img src="./picture/chp8/sample.png" width="100%">
</p>

]
.panel[.panel-name[é…å¯¹æ ·æœ¬tæ£€éªŒ]

.pull-left[

```{r,results='hide'}
stats::t.test(
  x = df.penguin$Temperature_t1, #ç¬¬1æ¬¡
  y = df.penguin$Temperature_t2, #ç¬¬2æ¬¡
  paired = TRUE) 
  
```


<br>
<p align="center">
  <img src="./picture/chp8/compare3.1.png" width="100%">
</p>
]
.pull-right[

```{r, results='hide'}
bruceR::TTEST(
  data = df.penguin, # æ•°æ®
  y = c("Temperature_t1",  
        "Temperature_t2"), # å˜é‡ä¸ºä¸¤æ¬¡æ ¸å¿ƒä½“æ¸©
  paired = T)  # é…å¯¹æ•°æ®ï¼Œé»˜è®¤æ˜¯FALSE
```

<br>
<p align="center">
  <img src="./picture/chp8/pair.png" width="100%">
</p>
]
]]]]

---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
<br>
<br>

|       | Rè‡ªå¸¦å‡½æ•° | çº¿æ€§æ¨¡å‹ | è§£é‡Š |
|-------|-------|-------|-------|
| å•æ ·æœ¬*t* | t.test(y, mu = 0) | lm(y ~ 1)| ä»…æœ‰æˆªè·çš„å›å½’æ¨¡å‹ |
| ç‹¬ç«‹æ ·æœ¬*t* | t.test($y_1$, $y_2$) | lm(y ~ 1 + $G_2$)| è‡ªå˜é‡ä¸ºäºŒåˆ†å˜é‡çš„å›å½’æ¨¡å‹ |
| é…å¯¹æ ·æœ¬*t* | t.test($y_1$, $y_2$, paired=T)  | lm($y_1$ - $y_2$ ~ 1)| ä»…æœ‰æˆªè·çš„å›å½’æ¨¡å‹)|


---
class: center, middle
<span style="font-size: 60px;">8.2  ANOVA & linear regression</span> <br>


---
class: left, middle
<span style="font-size: 60px;">8.2.1  ç ”ç©¶é—®é¢˜</span> <br>

<br>
<span style="font-size: 35px;">Q: å¦‚ä½•åŒæ—¶æ¯”è¾ƒä¸åŒèµ¤é“è·ç¦»(DEQ)å’Œä¸åŒæ‹çˆ±çŠ¶æ€(romantic)ä¸‹è¢«è¯•ä½“æ¸©çš„å·®å¼‚</span> <br>
<br>
<span style="font-size: 40px;">A: åŒå› ç´ è¢«è¯•é—´æ–¹å·®åˆ†æ</span> <br>


---
# 8.2  ANOVA & linear regression
## 8.2.2 ä»£ç å®æ“ & çŸ¥è¯†å›é¡¾
.pull-left[
<br>
**æ–¹æ³•ç®€ä»‹ï¼š**

å½“ç ”ç©¶è€…æƒ³è¦æ¯”è¾ƒä¸¤ä¸ªæˆ–å¤šä¸ªç»„ä¹‹é—´çš„å‡å€¼å·®å¼‚æ—¶ï¼Œå¯ä½¿ç”¨æ–¹å·®åˆ†æ(Analysis of Varianceï¼Œç®€ç§°ANOVA)ã€‚<br>
<br>
å®ƒç”±è‹±å›½ç»Ÿè®¡å­¦å®¶R.A.Fisheræå‡ºï¼ŒåŸºæœ¬æ€æƒ³æ˜¯ï¼Œåœ¨**å®éªŒ**ç ”ç©¶ä¸­ï¼Œå°†æµ‹é‡æ•°æ®çš„æ€»å˜å¼‚ï¼ˆå³æ€»æ–¹å·®ï¼‰æŒ‰ç…§å˜å¼‚æ¥æºåˆ†ä¸ºå¤„ç†ï¼ˆç»„é—´ï¼‰æ•ˆåº”å’Œè¯¯å·®ï¼ˆç»„å†…ï¼‰æ•ˆåº”ï¼Œå¹¶ä½œå‡ºå…¶æ•°é‡ä¼°è®¡ï¼Œä»è€Œç¡®å®šå®éªŒå¤„ç†å¯¹ç ”ç©¶ç»“æœå½±å“åŠ›çš„å¤§å°ã€‚

**å‡è®¾ï¼š**
* $H_0$: å„å› ç´ å„ä¸ªæ°´å¹³ä¸‹ï¼Œå› å˜é‡çš„å‡å€¼å®Œå…¨ç›¸åŒ
* $H_1$: å„å› ç´ å„ä¸ªæ°´å¹³ä¸‹ï¼Œå› å˜é‡çš„å‡å€¼ä¸å®Œå…¨ç›¸åŒ
]

.pull-right[
<br>
<br>
<br>
<br>
**å‰ææ¡ä»¶ï¼š**

* å¯åŠ æ€§ï¼šå„æ•ˆåº”å¯åŠ ï¼Œå³è§‚æµ‹å€¼æ˜¯ç”±å„ä¸»æ•ˆåº”ï¼Œäº¤äº’ä½œç”¨ä»¥åŠè¯¯å·®é€šè¿‡ç›¸åŠ å¾—åˆ°çš„<br>
* éšæœºæ€§ï¼šå„æ ·æœ¬ï¼ˆè§‚æµ‹å€¼ï¼‰æ˜¯éšæœºæ ·æœ¬<br>
* æ­£æ€æ€§ï¼šå„æ ·æœ¬æ¥è‡ªäºæ­£æ€åˆ†å¸ƒçš„æ€»ä½“<br>
* ç‹¬ç«‹æ€§ï¼šå„æ ·æœ¬è§‚æµ‹å€¼äº’ç›¸ç‹¬ç«‹<br>
* æ–¹å·®é½æ€§ï¼šå„æ ·æœ¬æ¥è‡ªçš„æ€»ä½“æ–¹å·®ç›¸åŒ<br>
* å› å˜é‡åº”ä¸ºè¿ç»­å˜é‡<br>

]

---
# 8.2  ANOVA 
## 8.2.2 ä»£ç å®æ“|æ•°æ®é¢„å¤„ç†
.panelset[
.panel[.panel-name[vars]

```{r}
summary(df.penguin$DEQ)
```

```{r}
# è®¾å®šåˆ†å‰²ç‚¹
# [0-23.5 çƒ­å¸¦ï¼Œ 23.5-35 äºšçƒ­å¸¦]ï¼Œ [35-40 æš–æ¸©å¸¦ï¼Œ 40-50 ä¸­æ¸©å¸¦]ï¼Œ [50-66.5 å¯’æ¸©å¸¦]
breaks <- c(0, 35, 50, 66.5)

# è®¾å®šç›¸åº”çš„æ ‡ç­¾
labels <- c('çƒ­å¸¦', 'æ¸©å¸¦', 'å¯’æ¸©å¸¦')

# åˆ›å»ºæ–°çš„å˜é‡
df.penguin$climate <- cut(df.penguin$DEQ, 
                          breaks = breaks, 
                          labels = labels)
summary(df.penguin$climate)
```

.panel[.panel-name[tidy data]

```{r}
df <- df.penguin %>% 
  select(subjID, climate, romantic, Temperature) 
  
```

```{r example of df, echo=FALSE}
DT::datatable(head(df), fillContainer = TRUE)
```

]]]


---
# 8.2  ANOVA & linear regression
## 8.2.2 ä»£ç å®æ“|æ­£æ€æ€§æ£€éªŒ
.panelset[
.panel[.panel-name[KSæ£€éªŒ]

```{r}
# æ­£æ€æ€§æ£€éªŒ-Kolmogorov-Smirnovæ£€éªŒ
# è‹¥p >.05ï¼Œä¸èƒ½æ‹’ç»æ•°æ®ç¬¦åˆæ­£æ€åˆ†å¸ƒçš„é›¶å‡è®¾
ks.test(df$Temperature, 'pnorm')
```

```{r}
# è¿›è¡Œæ•°æ®è½¬æ¢ï¼Œè½¬æ¢åä»éæ­£æ€åˆ†å¸ƒ
df$Temperature_log <- log(df$Temperature)
ks.test(df$Temperature_log, 'pnorm')
```

.panel[.panel-name[qqå›¾]
```{r, fig.width=7, fig.height=5}
# æ­£æ€æ€§æ£€éªŒ-qqå›¾
qqnorm(df$Temperature)
qqline(df$Temperature, col = "red") # æ·»åŠ ç†è®ºæ­£æ€åˆ†å¸ƒçº¿
```

.panel[.panel-name[ç›´æ–¹å›¾]
```{r, fig.width=7, fig.height=5}
ggplot(df, aes(Temperature)) +
    geom_histogram(aes(y =..density..), color='black', fill='white', bins=30) +
    geom_density(alpha=.5, fill='red')
```

]]]]


---
# 8.2  ANOVA & linear regression
## 8.2.2 ä»£ç å®æ“|åŒå› ç´ è¢«è¯•é—´æ–¹å·®åˆ†æ
.panelset[
.panel[.panel-name[stats::aov()]

```{r}
aov1 <- stats::aov(Temperature ~ climate * romantic, data = df)
summary(aov1)
```

.panel[.panel-name[SPSS]
```{r, echo = FALSE, fig.width = 4.5, fig.height = 3}
knitr::include_graphics('picture/chp8/SPSS.png')
```

]]]


---
class: center, middle
<span style="font-size: 60px;">ç»“æœä¸ºä»€ä¹ˆä¸ç›¸åŒï¼Ÿ</span> <br>


---
# 8.2  ANOVA & linear regression
## 8.2.2 ä»£ç å®æ“|å¹³æ–¹å’Œ(SS)çš„è®¡ç®—
<br>
åœ¨å¹³è¡¡è®¾è®¡ä¸­ï¼Œä¸‰ç§ç±»å‹çš„å¹³æ–¹å’Œçš„ç»“æœä¼šå¾ˆæ¸…æ™°ï¼Œå¹¶ä¸”æ–¹å·®åˆ†æçš„ç»“æœç‹¬ç«‹äºå¹³æ–¹å’Œçš„ç±»å‹ï¼›<br>
è€Œåœ¨éå¹³è¡¡è®¾è®¡ä¸­ï¼Œå°¤å…¶æ˜¯å½“å„ç»„æ ·æœ¬é‡å·®è·è¾ƒå¤§æ—¶ï¼Œä¸‰ç§ç±»å‹çš„å¹³æ–¹å’Œè®¡ç®—ç»“æœå¯èƒ½ä¼šä¸åŒï¼Œæ­¤æ—¶éœ€è¦æ ¹æ®å…·ä½“ç ”ç©¶è®¾è®¡å’Œé—®é¢˜æ¥é€‰æ‹©ä½¿ç”¨å“ªä¸€ç§ç±»å‹çš„å¹³æ–¹å’Œã€‚<br>
<br>
å¯¹äº Y ~ A + B + A * B<br>
<br>
.panelset[
.panel[.panel-name[Type I SS]
<br>
è§£é‡Šå˜é‡çš„é¡ºåºä¼šå½±å“åˆ°ç±»å‹Iå¹³æ–¹å’Œçš„è®¡ç®—ç»“æœï¼Œé€šå¸¸ç”¨äºé¡ºåºé‡è¦çš„æ¨¡å‹ã€‚<br>
æ•ˆåº”æ ¹æ®è¡¨è¾¾å¼ä¸­å…ˆå‡ºç°çš„æ•ˆåº”åšè°ƒæ•´ã€‚Aä¸åšè°ƒæ•´ï¼ŒBæ ¹æ®Aè°ƒæ•´ï¼ŒA:Bäº¤äº’é¡¹æ ¹æ®Aå’ŒBè°ƒæ•´ã€‚<br>
<br>
**stats::aov()å‡½æ•°é»˜è®¤é‡‡ç”¨çš„å°±æ˜¯Type I SSï¼Œå®ƒé€æ­¥å°†æ¯ä¸€ä¸ªå› å­å¼•å…¥æ¨¡å‹è¿›è¡Œè®¡ç®—ã€‚**<br>

.panel[.panel-name[Type II SS]
<br>
å¿½ç•¥äº†å› å­ä¹‹é—´å¯èƒ½å­˜åœ¨çš„äº¤äº’ä½œç”¨ï¼Œé€‚ç”¨äºæ‰€æœ‰ä¸»æ•ˆåº”ä¸æ¶‰åŠäº¤äº’æ•ˆåº”çš„æƒ…å†µã€‚<br>
å‡å®šæ‰€æœ‰çš„å› å­éƒ½æ˜¯åŒæ—¶è¿›å…¥æ¨¡å‹çš„ï¼Œå¹¶ä¸”å®ƒä»¬éƒ½æ˜¯ç­‰ä»·çš„ã€‚<br>
æ•ˆåº”æ ¹æ®åŒæ°´å¹³æˆ–ä½æ°´å¹³çš„æ•ˆåº”åšè°ƒæ•´ã€‚Aæ ¹æ®Bè°ƒæ•´ï¼ŒBä¾æ®Aè°ƒæ•´ï¼ŒA:Bäº¤äº’é¡¹åŒæ—¶æ ¹æ®Aå’ŒBè°ƒæ•´ã€‚<br>
<br>
**car::Anova()å‡½æ•°é»˜è®¤è®¡ç®—Type II SSï¼Œå¯ä»¥é€šè¿‡type = 3è°ƒæ•´ä¸ºType III SSã€‚**<br>

.panel[.panel-name[Type III SS]
<br>
æ›´å…¨é¢ï¼Œå‡å®šæ‰€æœ‰å› å­ï¼ˆä»¥åŠå®ƒä»¬çš„äº¤äº’é¡¹ï¼‰éƒ½æ˜¯é‡è¦çš„ï¼Œå¹¶è€ƒè™‘æ‰€æœ‰å› ç´ ã€‚<br>
æ¯ä¸ªæ•ˆåº”æ ¹æ®æ¨¡å‹å…¶ä»–å„æ•ˆåº”åšç›¸åº”è°ƒæ•´ã€‚Aæ ¹æ®Bå’ŒA:Båšè°ƒæ•´ï¼ŒA:Bäº¤äº’é¡¹æ ¹æ®Aå’ŒBè°ƒæ•´ã€‚<br>
<br>
**SPSSé»˜è®¤é‡‡ç”¨Type III SSã€‚**<br>
**bruceR::MANOVA*()å‡½æ•°ä¹Ÿé»˜è®¤é‡‡ç”¨Type III SSï¼Œå¯ä»¥é€šè¿‡ss.type = 2è°ƒæ•´ä¸ºType II SSã€‚**<br>

]]]]




---
# 8.2  ANOVA & linear regression
## 8.2.2 ä»£ç å®æ“|åŒå› ç´ è¢«è¯•é—´æ–¹å·®åˆ†æ
.panelset[
.panel[.panel-name[car::Anova()]
```{r}
# ç»“æœä¸ä¸€è‡´ï¼ŒåŸå› PPTæ˜¾ç¤ºä¸å…¨ï¼Œè¯·å›åˆ°rmdæ–‡æ¡£æŸ¥çœ‹
aov1 <- car::Anova(stats::aov(Temperature ~ climate * romantic, data = df))
aov1
```

```{r}
# åŸå› debug
# æŸ¥çœ‹Rçš„é»˜è®¤å¯¹æ¯”è®¾ç½®
options("contrasts")
# ä»è¾“å‡ºç»“æœå¯çŸ¥ï¼Œæ— åºé»˜è®¤ä¸ºcontr.treatment()ï¼Œæœ‰åºé»˜è®¤ä¸ºcontr.poly()
# factor()å‡½æ•°æ¥åˆ›å»ºæ— åºå› å­ï¼Œordered()å‡½æ•°åˆ›å»ºæœ‰åºå› å­

is.factor(df$climate)
is.ordered(df$climate)
# climateæ˜¯æ— åºå› å­

# åˆ›å»ºä¸€ä¸ª3æ°´å¹³çš„å› å­çš„åŸºå‡†å¯¹æ¯”
c1 <- contr.treatment(3)

# åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹æ¯”ï¼Œè¿™ä¸ªç¼–ç å‡è®¾åˆ†ç±»æ°´å¹³ä¹‹é—´çš„å·®å¼‚è¢«ç­‰åˆ†ï¼Œæ¯ä¸€ä¸ªæ°´å¹³ä¸æ€»å‡å€¼çš„å·®å¼‚ç­‰äº1/3
my.coding <- matrix(rep(1/3, 6), ncol=2)
# å°†å¯¹æ¯”è°ƒæ•´ä¸ºæ¯ä¸ªæ°´å¹³ä¸ç¬¬ä¸€ä¸ªæ°´å¹³çš„æŒ¯å¹…å‡å»1/3
# å¯èƒ½çš„åŸå› ï¼šé™¤äº†å…³å¿ƒæ¯ä¸ªæ°´å¹³å¯¹åº”çš„æ•ˆæœï¼ŒåŒæ—¶ä¹Ÿå…³å¿ƒæ°´å¹³ä¸æ°´å¹³ä¹‹é—´çš„æ•ˆæœ
my.simple <- c1-my.coding
my.simple

# æ›´æ”¹climateçš„å¯¹æ¯”
contrasts(df$climate) <- my.simple

# å°†æ•°æ®é›†dfçš„romanticåˆ—çš„å¯¹æ¯”è®¾ä¸ºç­‰è·å¯¹æ¯”ï¼Œå®ƒå‡è®¾åˆ†ç±»æ°´å¹³ä¹‹é—´çš„å·®å¼‚ä¸ºç­‰è·ç¦»
contrasts(df$romantic) <- contr.sum(2)/2

# æ–¹å·®åˆ†æ
aov1 <- car::Anova(lm(Temperature ~ climate * romantic, data = df),
                   type = 3)
aov1
```

.panel[.panel-name[afex::aov_ez()]
```{r}
afex::aov_ez(id = "subjID", 
             dv = "Temperature", 
             data = df, 
             between = c("climate", "romantic"), 
             type = 3)
```

```{r,results='hide'}
# afexä¸­çš„å…¶ä»–å‡½æ•°å¯ä»¥å¾—åˆ°åŒæ ·çš„ç»“æœ
afex::aov_car(Temperature ~ climate * romantic + Error(subjID), data = df, type = 3)
afex::aov_4(Temperature ~ climate * romantic + (1|subjID), data = df)
```


]]]

---
# 8.2  ANOVA & linear regression
## 8.2.3 çº¿æ€§å›å½’

.pull-left[

<br>
<br>
<br>
è¿™é‡Œçš„ANOVAä»ç„¶æ˜¯çº¿æ€§å›å½’æ¨¡å‹çš„ç‰¹ä¾‹ï¼Œå³è‡ªå˜é‡æ˜¯ç¦»æ•£å˜é‡çš„æƒ…å†µã€‚
<br>
å¦‚æœä½¿ç”¨å“‘å˜é‡ï¼ˆdummy codingï¼‰å¯¹è‡ªå˜é‡è¿›è¡Œç¼–ç åè¿›å…¥å›å½’æ–¹ç¨‹ï¼Œçº¿æ€§æ¨¡å‹ä¸­çš„æ–œç‡å³æ˜¯å¯¹ç»„é—´å·®å¼‚çš„ä¼°è®¡ã€‚<br>
<br>
**åŒå› ç´ æ–¹å·®åˆ†æå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§å›å½’æ¨¡å‹ï¼Œè‡ªå˜é‡ä¸ºä¸¤ä¸ªåˆ†ç±»å˜é‡ã€‚**<br>

]

.pull-right[
<br>
<br>
```{r, echo = FALSE, fig.width = 3.5, fig.height = 2}
knitr::include_graphics('picture/chp8/aovLM.png')
```
]

---
# 8.2  ANOVA & linear regression
## 8.2.3 çº¿æ€§å›å½’
.pull-left[

```{r,results='hide'}
aov1 <- car::Anova(
  aov(Temperature ~ climate * romantic, 
      data = df), 
  type = 3
  )
aov1
```
<br>
![](./picture/chp8/compare8231.png)
]



.pull-right[

```{r,results='hide'}
lm1 <- car::Anova(
  lm(Temperature ~ climate * romantic, 
     data = df), 
  type = 3
  )
lm1
```
<br>
![](./picture/chp8/compare8232.png)

]


---
# 8.2  ANOVA & linear regression
## 8.2.2 ä»£ç å®æ“: `bruceR`
* ä½¿ç”¨`bruceR`å¯ä»¥æ›´ç®€å•åœ°å®ç°å¿ƒç†å­¦ä¸­ä¹ æƒ¯çš„ANOVAï¼Œä½†è¦æ³¨æ„æ•°æ®æ ¼å¼
<p align="center">
  <img src="./picture/chp8/ANOVA data.png" width="65%">
</p>


---
# 8.2  ANOVA & linear regression
## 8.2.2 ä»£ç å®æ“: `bruceR::MANOVA`
<p align="center">
  <img src="./picture/chp8/MANOVA.png" width="70%">
</p>


---
# 8.2  ANOVA & linear regression
## 8.2.2 ä»£ç å®æ“: `bruceR::MANOVA`
```{r,results='hide'}
res1 <- bruceR::MANOVA(data = df, 
                       dv = "Temperature", 
                       between = c("climate", "romantic"))
```
```{r,echo=FALSE}
res1 %>%
  capture.output()
```


---
# 8.2  ANOVA & linear regression
## 8.2.2 ä»£ç å®æ“: `bruceR::EMMEANS`
æ›´è¿›ä¸€æ­¥è¿›è¡Œç®€å•æ•ˆåº”åˆ†æä¸å¤šé‡æ¯”è¾ƒ
<p align="center">
  <img src="./picture/chp8/EMMEANS.png" width="70%">
</p>


---
# 8.2  ANOVA & linear regression
## 8.2.2 ä»£ç å®æ“: `bruceR::EMMEANS`
```{r, results='asis'}
sim_eff <- res1 %>% 
  bruceR::EMMEANS("climate", by = "romantic") %>%
  bruceR::EMMEANS("romantic", by = "climate")
```

---
# 8.2  ANOVA & linear regression
## 8.2.4 çŸ¥è¯†å»¶ç”³|å•å› ç´ æ–¹å·®åˆ†æç¤ºä¾‹
```{r}
# DEQå¯¹Temperatureçš„å½±å“
res2 <- bruceR::MANOVA(
  data = df,
  dv = "Temperature",
  between = "climate") 
```


---
# 8.2  ANOVA & linear regression
## 8.2.4 çŸ¥è¯†å»¶ç”³|æ€»ç»“
<br>
<br>

|       | Rè‡ªå¸¦å‡½æ•° | çº¿æ€§æ¨¡å‹ | è§£é‡Š |
|-------|-------|-------|-------|
| å•å› ç´ ANOVA | aov(y ~ G) | lm(y ~ 1 + $G_1$ + $G_2$ + ...)| ä¸€ä¸ªç¦»æ•£è‡ªå˜é‡çš„å›å½’æ¨¡å‹ |
| å¤šå› ç´ ANOVA | aovt(y ~ G * S) | lm(y ~ $G_1$ + $G_2$ + ... + $S_1$ + $S_2$ + ...)| å¤šä¸ªç¦»æ•£è‡ªå˜é‡çš„å›å½’æ¨¡å‹ |


---
<h1 lang="zh-CN" style="font-size: 60px;">è¯¾å ‚æ€»ç»“</h1>

![](./picture/chp8/route.png)


---
<h1 lang="zh-CN" style="font-size: 60px;">è¯¾å ‚æ€»ç»“</h1>

|       | Rè‡ªå¸¦å‡½æ•° | çº¿æ€§æ¨¡å‹ | è§£é‡Š |
|-------|-------|-------|-------|
| å•æ ·æœ¬*t* | t.test(y, mu = 0) | lm(y ~ 1)| ä»…æœ‰æˆªè·çš„å›å½’æ¨¡å‹ |
| ç‹¬ç«‹æ ·æœ¬*t* | t.test($y_1$, $y_2$) | lm(y ~ 1 + $G_2$)| è‡ªå˜é‡ä¸ºäºŒåˆ†å˜é‡çš„å›å½’æ¨¡å‹ |
| é…å¯¹æ ·æœ¬*t* | t.test($y_1$, $y_2$, paired=T)  | lm($y_1$ - $y_2$ ~ 1)| ä»…æœ‰æˆªè·çš„å›å½’æ¨¡å‹)|
| å•å› ç´ ANOVA | aov(y ~ G) | lm(y ~ 1 + $G_1$ + $G_2$ + ...)| ä¸€ä¸ªç¦»æ•£è‡ªå˜é‡çš„å›å½’æ¨¡å‹ |
| å¤šå› ç´ ANOVA | aovt(y ~ G * S) | lm(y ~ $G_1$ + $G_2$ + ... + $S_1$ + $S_2$ + ...)| å¤šä¸ªç¦»æ•£è‡ªå˜é‡çš„å›å½’æ¨¡å‹ |

å‚è€ƒï¼šhttps://lindeloev.github.io/tests-as-linear/#61_one-way_anova_and_kruskal-wallis


---
class: center, middle
<span style="font-size: 60px;">æ€è€ƒ</span> <br>
<span style="font-size: 55px;">å¦‚ä½•ä»å›å½’æ¨¡å‹çš„è§’åº¦ç†è§£é‡å¤æµ‹é‡æ–¹å·®åˆ†æå‘¢ï¼Ÿ</span> <br>


---
<h1 lang="zh-CN" style="font-size: 60px;">è¯¾å ‚ç»ƒä¹ </h1>
<br>
<br>
<br>
<h2 lang="zh-CN">1. åœ¨Penguinæ•°æ®ä¸­ï¼Œå¤„åœ¨ä¸åŒæ‹çˆ±çŠ¶æ€ä¸‹(romantic)çš„è¢«è¯•åœ¨ç¤¾äº¤å¤æ‚åº¦(socialdiversity)ä¸Šæ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚ï¼Ÿ</h2>
<br>
<br>
<h2 lang="zh-CN">2. åœ¨Penguinæ•°æ®ä¸­ï¼Œä¸åŒæ°”å€™å¸¦(DEQ)ä¸æ‹çˆ±çŠ¶æ€(romantic)å¯¹è¢«è¯•ç¤¾äº¤å¤æ‚åº¦(socialdiversity)çš„å½±å“.</h2>


