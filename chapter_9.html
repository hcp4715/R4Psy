<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>chapter_9.knit</title>
    <meta charset="utf-8" />
    <meta name="author" content="Pac_B" />
    <script src="libs/header-attrs-2.29/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet" />
    <script src="libs/panelset-0.2.6/panelset.js"></script>
    <link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.33/datatables.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="css/Custumed_Style.css" type="text/css" />
    <link rel="stylesheet" href="css/zh-CN.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">


class: center, middle
&lt;span style="font-size: 50px;"&gt;**ç¬¬å…«ç« **&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 50px;"&gt;å›å½’æ¨¡å‹(ä¸€)&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 30px;"&gt;èƒ¡ä¼ é¹&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt; &lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 30px;"&gt;2025-04-16&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt; Made with Rmarkdown&lt;/span&gt; &lt;br&gt;



&lt;style type="text/css"&gt;
/* ---- extra.css ---- */
.bigfont {
  font-size: 30px;
}
.size5{
font-size: 20px;
}
.tit_font{
font-size: 60px;
}

&lt;/style&gt;







---
&lt;h1 lang="zh-CN" style="font-size: 60px;"&gt; &lt;/h1&gt;
&lt;br&gt;
&lt;br&gt;
## çº¯ç²¹çš„Rä»£ç å­¦ä¹  â†’ ä½¿ç”¨Rè¯­è¨€æ¥å®ç°**ç»Ÿè®¡çŸ¥è¯†** &lt;br&gt;
&lt;br&gt;
## (1) R: æ›´çµæ´»çš„ç»Ÿè®¡åˆ†ææ–¹æ³•ï¼Œä¸ç»Ÿè®¡çŸ¥è¯†ç»“åˆæ›´åŠ ç´§å¯†&lt;br&gt;
&lt;br&gt;
## (2) å¿ƒç†å­¦/ç¤¾ä¼šç§‘å­¦ä¸­å¸¸ç”¨çš„ç»Ÿè®¡æ£€éªŒå‡æ˜¯å›å½’æ¨¡å‹&lt;br&gt;

---
&lt;h1 lang="zh-CN" style="font-size: 60px;"&gt;ç ”ç©¶é—®é¢˜&lt;/h1&gt;

&lt;br&gt;
## åœ¨Human Penguin Projectæ•°æ®ä¸­ï¼Œç¬¬ä¸€æ¬¡ä½“æ¸©èƒ½å¦é¢„æµ‹ç¬¬äºŒæ¬¡ä½“æ¸©ï¼Ÿ
&lt;br&gt;

&lt;br&gt;
## åœ¨Human Penguin Projectæ•°æ®ä¸­ï¼Œä¸åŒæ‹çˆ±çŠ¶æ€(romantic)ä¸‹è¢«è¯•æ ¸å¿ƒä½“æ¸©(Temperature)æ˜¯å¦æœ‰å·®å¼‚ï¼Ÿ
&lt;br&gt;
&lt;br&gt;
## åœ¨Human Penguin Projectæ•°æ®ä¸­ï¼Œä¸åŒè·èµ¤é“è·ç¦»(DEQ)å’Œæ‹çˆ±çŠ¶æ€(romantic)æ¡ä»¶ä¸‹è¢«è¯•æ ¸å¿ƒä½“æ¸©(Temperature)æ˜¯å¦æœ‰å·®å¼‚ï¼Ÿ
&lt;br&gt;
&lt;br&gt;

---
&lt;h1 lang="en" style="font-size: 60px;"&gt;Contents&lt;/h1&gt;
&lt;br&gt;
&lt;span style="font-size: 35px;"&gt;8.0 ç®€å•çº¿æ€§å›å½’&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.0.1 çº¿æ€§å›å½’æ¨¡å‹å›é¡¾&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.0.2 çº¿æ€§å›å½’åœ¨Rä¸­çš„å®ç°&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.0.3 bruceR::regress&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;br&gt;
&lt;span style="font-size: 35px;"&gt;8.1 *t*-test &amp; linear regression&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.1.1 ç‹¬ç«‹æ ·æœ¬*t*æ£€éªŒ&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.1.2 çº¿æ€§å›å½’çš„è¡¨è¾¾&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.1.3 å•æ ·æœ¬*t*æ£€éªŒ&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.1.4 é…å¯¹æ ·æœ¬*t*æ£€éªŒ&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.1.5 bruceR::TTEST&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;br&gt;
&lt;span style="font-size: 35px;"&gt;8.2 ANOVA &amp; linear regression&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.2.1 ç ”ç©¶é—®é¢˜&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.2.2 ä»£ç å®æ“&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.2.3 çº¿æ€§å›å½’çš„è¡¨è¾¾&lt;/span&gt;&lt;/center&gt; &lt;br&gt;
&lt;span style="font-size: 20px;"&gt;&amp;emsp;8.2.4 çŸ¥è¯†å»¶ç”³&lt;/span&gt;&lt;/center&gt; &lt;br&gt;


---
class: center, middle
&lt;span style="font-size: 60px;"&gt;8.1 *t*-test &amp; linear regression&lt;/span&gt; &lt;br&gt;

---
class: left, middle
&lt;span style="font-size: 60px;"&gt;8.0 çº¿æ€§å›å½’å›é¡¾&lt;/span&gt; &lt;br&gt;

&lt;br&gt;
&lt;span style="font-size: 35px;"&gt;Q: ç¬¬ä¸€æ¬¡ä½“æ¸©æµ‹é‡æ˜¯å¦ä¸ç¬¬äºŒä½“æ¸©æµ‹é‡çš„å…³ç³»ï¼Ÿ&lt;/span&gt; &lt;br&gt;
&lt;br&gt;
&lt;span style="font-size: 40px;"&gt;A: ç®€å•çº¿æ€§å›å½’&lt;/span&gt; &lt;br&gt;

---

## çº¿æ€§å›å½’è¡¨è¾¾å¼

&lt;/br&gt;

`\(y = a + bX + \epsilon\)`

&lt;/br&gt;

-   y -- Data

-   a+bX -- model

-   `\(\epsilon\)` -- error

---

## çº¿æ€§å›å½’è¡¨è¾¾å¼
&lt;span style="font-size: 30px;"&gt;
&lt;/br&gt;

`$$y = a + bX + \epsilon$$`

-   y -- å› å˜é‡ï¼ŒDependent variable

-   x -- è‡ªå˜é‡ï¼ŒIndependent (explanatory) variable

-   a -- æˆªè·ï¼ŒIntercept

-   b -- æ–œç‡ï¼ŒSlope

-   `\(\epsilon\)` -- æ®‹å·®ï¼ŒResidual (error)
&lt;/span&gt;
---
## çº¿æ€§å›å½’è¡¨è¾¾å¼

&lt;/br&gt;

$$y_i = a + bx_i + \epsilon $$

`$$\downarrow$$`

`$$Y_1 = \alpha + \beta_1 X_1 + \epsilon_1$$`

`$$Y_2=\alpha + \beta_1 X_2 + \epsilon_2$$`

`$$...$$`

`$$Y_n = \alpha + \beta_1 X_n + \epsilon_n$$`
---
## çŸ©é˜µè¡¨è¾¾

`$$Y_{nÃ—1} =X_{nÃ—2} \beta_{2Ã—1} + \epsilon_{nÃ—1}$$`

`$$Y = X \beta + \epsilon$$`

&lt;div style="column-count: 4;"&gt;
`$$Y_{nÃ—1}=\begin{bmatrix}
  y_1 \\
  y_2 \\
  ... \\
  y_n
\end{bmatrix}$$`

`$$X_{nÃ—2}=\begin{bmatrix}
  1&amp;x_{12} \\
  1&amp;x_{22} \\
  ...&amp;... \\
  1&amp;x_{n2}
\end{bmatrix}$$`

`$$\beta_{2Ã—1}=\begin{bmatrix}
 \alpha\\
 \beta_1
\end{bmatrix}$$`

`$$\epsilon_{nÃ—1}=\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  ...\\
  \epsilon_n
  \end{bmatrix}$$`
&lt;/div&gt;

---
## ä»£ç è¡¨è¾¾(`r`)

&lt;/br&gt;

"Formula = Y ~ X"

&lt;/br&gt;

- `\(Y\)`: å› å˜é‡ 
- `\(X\)`: è‡ªå˜é‡

---
# 8.0 çº¿æ€§å›å½’å›é¡¾
## 8.0.2 ä¸€ä¸ªç®€å•çš„çº¿æ€§å›å½’çš„Rä»£ç 

.panelset[
.panel[.panel-name[åŸºç¡€çŸ¥è¯†]

&lt;br&gt;
**Xæ˜¯å¦èƒ½å¤Ÿâ€œé¢„æµ‹â€Y**
&lt;br&gt;
**å‰ææ¡ä»¶**
1.  æ¨¡å‹è®¾å®šå‡å®š(çº¿æ€§é¢„è®¾);

2.  æ­£äº¤é¢„è®¾(è¯¯å·®é¡¹ğå’Œxä¸ç›¸å…³; è¯¯å·®é¡¹ğçš„æœŸæœ›å€¼ä¸º0);

3.  æ®‹å·®æ–¹å·®é½æ€§é¢„è®¾;

4.  åˆ—å·®æ­£æ€åˆ†å¸ƒé¢„è®¾(æ®‹å·®é¡¹ğç‹¬ç«‹ä¸”åŒåˆ†å¸ƒ).&lt;br&gt;
&lt;br&gt;

**å‡è®¾**
* `\(H_0\)`: Xä¸èƒ½æ˜¾è‘—åœ°é¢„æµ‹Yï¼Œå³ `\(\beta\)` = 0
* `\(H_1\)`: Xèƒ½æ˜¾è‘—åœ°é¢„æµ‹Yï¼Œå³ `\(\beta\)` â‰  0
&lt;br&gt;

.panel[.panel-name[æ•°æ®æ¸…ç†]


``` r
df.penguin &lt;- bruceR::import(here::here('data', 'penguin', 'penguin_rawdata.csv')) %&gt;%
  dplyr::mutate(subjID = row_number()) %&gt;%
  dplyr::select(subjID,Temperature_t1, Temperature_t2) %&gt;%         # é€‰æ‹©å˜é‡
  dplyr::filter(!is.na(Temperature_t1) &amp; !is.na(Temperature_t2)) 
```

<div class="datatables html-widget html-fill-item" id="htmlwidget-cf4b90454bdc295efef1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cf4b90454bdc295efef1">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6"],[1,2,3,4,5,6],[36.8,34.2,35,36.1,35.72222222,35.3],[36.7,36.6,35.2,35.8,36.44444444,35.9]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>subjID<\/th>\n      <th>Temperature_t1<\/th>\n      <th>Temperature_t2<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"subjID","targets":1},{"name":"Temperature_t1","targets":2},{"name":"Temperature_t2","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[4,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

.panel[.panel-name[åˆæ­¥å¯è§†åŒ–]


``` r
df.penguin %&gt;%
      ggplot2::ggplot(aes(x = Temperature_t1, y = Temperature_t2)) +
      geom_point() +
      geom_smooth(method = "lm", se = TRUE) +
      theme_classic()
```

![](chapter_9_files/figure-html/visualization for lm-1.png)&lt;!-- --&gt;

.panel[.panel-name[ä»£ç å®æ“]


``` r
m1 &lt;- stats::lm(Temperature_t2 ~ Temperature_t1,  # å…¬å¼
          data = df.penguin,                # æ•°æ®æ¡†
          )

# ä½¿ç”¨ broom åŒ…çš„ glance() å‡½æ•°æ¥æå–æ¨¡å‹æ‘˜è¦ä¿¡æ¯
m1_summary &lt;- broom::tidy(m1)

# ä½¿ç”¨ knitr åŒ…çš„ kable() å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ ¼å¼åŒ–çš„è¡¨æ ¼
knitr::kable(m1_summary, caption = "Model Summary")
```



Table: Model Summary

|term           |   estimate| std.error| statistic| p.value|
|:--------------|----------:|---------:|---------:|-------:|
|(Intercept)    | 22.8090106| 0.5533846|  41.21728|       0|
|Temperature_t1 |  0.3774158| 0.0152520|  24.74526|       0|
.panel[.panel-name[bruceR::model_summary]



``` r
bruceR::model_summary(m1)
```

```
## 
## Model Summary
## 
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
##                 (1) Temperature_t2
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## (Intercept)       22.809 ***      
##                   (0.553)         
## Temperature_t1     0.377 ***      
##                   (0.015)         
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## R^2                0.292          
## Adj. R^2           0.291          
## Num. obs.       1487              
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## Note. * p &lt; .05, ** p &lt; .01, *** p &lt; .001.
```
]
]
]
]
]
]
---
# 8.0 çº¿æ€§å›å½’å›é¡¾
## 8.0.3 bruceR::regress


``` r
m2 &lt;- bruceR::regress(Temperature_t2 ~ Temperature_t1,  # å…¬å¼
          data = df.penguin, ) # æ•°æ®
```

```
## 
## General Linear Model (OLS Regression)
## 
## Model Fit:
## F(1, 1485) = 612.33, p &lt; 0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001 ***
## RÂ² = 0.29196 (Adjusted RÂ² = 0.29148)
## 
## Unstandardized Coefficients:
## Outcome Variable: Temperature_t2
## N = 1487
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
##                      b    S.E.      t     p        [95% CI of b] VIF
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## (Intercept)     22.809 (0.553) 41.217 &lt;.001 *** [21.724, 23.895]    
## Temperature_t1   0.377 (0.015) 24.745 &lt;.001 *** [ 0.347,  0.407]    
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

```
## Standardized Coefficients (Î²):
## Outcome Variable: Temperature_t2
## N = 1487
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
##                     Î²    S.E.      t     p      [95% CI of Î²] r(partial) r(part)
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## Temperature_t1  0.540 (0.022) 24.745 &lt;.001 *** [0.497, 0.583]      0.540   0.540
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```
---
class: left, middle
&lt;span style="font-size: 60px;"&gt;8.1  *t*æ£€éªŒä½œä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹&lt;/span&gt; &lt;br&gt;

&lt;img src="picture/chp8/IJzerman2018fig.png" width="2303" /&gt;
(å¼•è‡ª[IJzerman et al., 2018](https://doi.org/10.1525/collabra.165))

&lt;br&gt;
&lt;span style="font-size: 35px;"&gt;Q: ä¸åŒæ‹çˆ±çŠ¶æ€(romantic)ä¸‹äººä»¬çš„æ ¸å¿ƒä½“æ¸©(Temperature)æ˜¯å¦æœ‰å·®å¼‚ï¼Ÿ&lt;/span&gt; &lt;br&gt;
&lt;br&gt;
&lt;span style="font-size: 40px;"&gt;A: ç‹¬ç«‹æ ·æœ¬*t*æ£€éªŒ&lt;/span&gt; &lt;br&gt;

---
# 8.1 *t*-test
## 8.1.1 ç‹¬ç«‹æ ·æœ¬*t*æ£€éªŒ(independent *t*-test)

.panelset[
.panel[.panel-name[åŸºç¡€çŸ¥è¯†]

&lt;br&gt;
**æ¯”è¾ƒä¸¤ä¸ªç‹¬ç«‹æ ·æœ¬ç¾¤ä½“çš„å‡å€¼æ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚ã€‚**
&lt;br&gt;
**å‰ææ¡ä»¶**
* æ­£æ€æ€§ï¼šä¸¤ä¸ªæ ·æœ¬æ•°æ®éƒ½åº”è¯¥æ¥è‡ªæ­£æ€åˆ†å¸ƒçš„æ€»ä½“ã€‚æ ·æœ¬é‡è¶³å¤Ÿå¤§æ—¶ï¼Œå³ä½¿ä¸ä¸¥æ ¼æœä»æ­£æ€åˆ†å¸ƒï¼Œç»“æœä¹Ÿæ˜¯ç¨³å¥çš„ã€‚
* åŒæ–¹å·®æ€§ï¼šä¸¤ä¸ªæ ·æœ¬çš„æ–¹å·®åº”è¯¥æ˜¯ç›¸ç­‰çš„ã€‚
* ç‹¬ç«‹æ€§ï¼šä¸¤ä¸ªæ ·æœ¬åº”è¯¥æ˜¯ç‹¬ç«‹çš„ï¼Œå³ä¸€ä¸ªæ ·æœ¬çš„è§‚æµ‹å€¼ä¸åº”å½±å“å¦ä¸€ä¸ªæ ·æœ¬çš„è§‚æµ‹å€¼ã€‚&lt;br&gt;
&lt;br&gt;

**å‡è®¾**
* `\(H_0\)`: ä¸¤ä¸ªç‹¬ç«‹æ ·æœ¬ç¾¤ä½“çš„å‡å€¼æ²¡æœ‰æ˜¾è‘—å·®å¼‚ï¼Œå³ `\(Î¼_1\)` = `\(Î¼_2\)`
* `\(H_1\)`: ä¸¤ä¸ªç‹¬ç«‹æ ·æœ¬ç¾¤ä½“çš„å‡å€¼æœ‰æ˜¾è‘—å·®å¼‚ï¼Œå³ `\(Î¼_1\)` â‰  `\(Î¼_2\)`
&lt;br&gt;
`$$t = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}$$`

.panel[.panel-name[æ•°æ®æ¸…ç†]


``` r
df.penguin &lt;- bruceR::import(here::here('data', 'penguin', 'penguin_rawdata.csv')) %&gt;%
  dplyr::mutate(subjID = row_number()) %&gt;%
  dplyr::select(subjID,Temperature_t1, Temperature_t2, socialdiversity, 
                Site, DEQ, romantic, ALEX1:ALEX16) %&gt;%                                     # é€‰æ‹©å˜é‡
  dplyr::filter(!is.na(Temperature_t1) &amp; !is.na(Temperature_t2) &amp; !is.na(DEQ)) %&gt;%         # å¤„ç†ç¼ºå¤±å€¼
  dplyr::mutate(romantic = factor(romantic, levels = c(1,2), labels = c("æ‹çˆ±", "å•èº«")),  # è½¬åŒ–ä¸ºå› å­
                Temperature = rowMeans(select(., starts_with("Temperature"))),             # è®¡ç®—ä¸¤æ¬¡æ ¸å¿ƒæ¸©åº¦çš„å‡å€¼
                ALEX4  = case_when(TRUE ~ 6 - ALEX4),
                ALEX12 = case_when(TRUE ~ 6 - ALEX12),
                ALEX14 = case_when(TRUE ~ 6 - ALEX14),
                ALEX16 = case_when(TRUE ~ 6 - ALEX16),
                ALEX   = rowSums(select(., starts_with("ALEX")))) # åå‘è®¡åˆ†åè®¡ç®—æ€»åˆ†
```

<div class="datatables html-widget html-fill-item" id="htmlwidget-3f1a544325f6241153dc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3f1a544325f6241153dc">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6"],[1,2,3,4,5,6],[36.8,34.2,35,36.1,35.72222222,35.3],[36.7,36.6,35.2,35.8,36.44444444,35.9],[8,6,5,7,5,7],["Tsinghua","Oxford","Oxford","Oxford","Chile","Bamberg"],[26.88780212,51.75,51.75,51.75,42.07719421,51.65660095],["å•èº«","æ‹çˆ±","æ‹çˆ±","æ‹çˆ±","æ‹çˆ±","æ‹çˆ±"],[2,1,2,3,1,1],[2,1,2,4,1,2],[2,1,4,1,1,1],[4,5,4,4,5,4],[2,1,2,4,1,1],[2,1,2,2,1,3],[2,1,2,3,2,4],[2,1,2,4,1,2],[2,1,2,2,2,4],[1,1,1,1,1,2],[2,1,2,2,1,2],[4,4,3,4,4,2],[2,3,2,2,2,4],[4,4,4,4,4,5],[2,3,2,4,1,1],[4,4,4,4,2,5],[36.75,35.40000000000001,35.1,35.95,36.08333333,35.59999999999999],[31,23,34,40,24,35]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>subjID<\/th>\n      <th>Temperature_t1<\/th>\n      <th>Temperature_t2<\/th>\n      <th>socialdiversity<\/th>\n      <th>Site<\/th>\n      <th>DEQ<\/th>\n      <th>romantic<\/th>\n      <th>ALEX1<\/th>\n      <th>ALEX2<\/th>\n      <th>ALEX3<\/th>\n      <th>ALEX4<\/th>\n      <th>ALEX5<\/th>\n      <th>ALEX6<\/th>\n      <th>ALEX7<\/th>\n      <th>ALEX8<\/th>\n      <th>ALEX9<\/th>\n      <th>ALEX10<\/th>\n      <th>ALEX11<\/th>\n      <th>ALEX12<\/th>\n      <th>ALEX13<\/th>\n      <th>ALEX14<\/th>\n      <th>ALEX15<\/th>\n      <th>ALEX16<\/th>\n      <th>Temperature<\/th>\n      <th>ALEX<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,6,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"subjID","targets":1},{"name":"Temperature_t1","targets":2},{"name":"Temperature_t2","targets":3},{"name":"socialdiversity","targets":4},{"name":"Site","targets":5},{"name":"DEQ","targets":6},{"name":"romantic","targets":7},{"name":"ALEX1","targets":8},{"name":"ALEX2","targets":9},{"name":"ALEX3","targets":10},{"name":"ALEX4","targets":11},{"name":"ALEX5","targets":12},{"name":"ALEX6","targets":13},{"name":"ALEX7","targets":14},{"name":"ALEX8","targets":15},{"name":"ALEX9","targets":16},{"name":"ALEX10","targets":17},{"name":"ALEX11","targets":18},{"name":"ALEX12","targets":19},{"name":"ALEX13","targets":20},{"name":"ALEX14","targets":21},{"name":"ALEX15","targets":22},{"name":"ALEX16","targets":23},{"name":"Temperature","targets":24},{"name":"ALEX","targets":25}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[4,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

.panel[.panel-name[ä»£ç å®æ“]


``` r
stats::t.test(data = df.penguin,      # æ•°æ®æ¡†
              Temperature ~ romantic, # å› å˜é‡~è‡ªå˜é‡
              var.equal = TRUE) %&gt;%
  capture.output()                    # å°†è¾“å‡ºå˜æ•´é½
```

```
##  [1] ""                                                                                                    
##  [2] "\tTwo Sample t-test"                                                                                 
##  [3] ""                                                                                                    
##  [4] "data:  Temperature by romantic"                                                                      
##  [5] "t = -0.34664, df = 1425, p-value = 0.7289"                                                           
##  [6] "alternative hypothesis: true difference in means between group æ‹çˆ± and group å•èº« is not equal to 0"
##  [7] "95 percent confidence interval:"                                                                     
##  [8] " -0.0555949  0.0388971"                                                                              
##  [9] "sample estimates:"                                                                                   
## [10] "mean in group æ‹çˆ± mean in group å•èº« "                                                              
## [11] "          36.38498           36.39333 "                                                              
## [12] ""
```


]]]]

---
# 8.1 *t*-testä½œä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.2 çº¿æ€§å›å½’(linear regression)
&lt;br&gt;
* ç‹¬ç«‹æ ·æœ¬*t*æ£€éªŒæ˜¯çº¿æ€§æ¨¡å‹çš„ç‰¹æ®Šå½¢å¼(è‡ªå˜é‡ä¸ºäºŒåˆ†å˜é‡ï¼‰
--
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/indet-lm.png" width="55%"&gt;
&lt;/p&gt;


---
# 8.1 *t*-test &amp; linear regression

.pull-left[

``` r
# tæ£€éªŒ
stats::t.test(data = df.penguin,
              Temperature ~ romantic,
              var.equal = TRUE) %&gt;%
      capture.output()                    # å°†è¾“å‡ºå˜æ•´é½
```

&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/compare1.1.png" width="100%"&gt;
&lt;/p&gt;
]

.pull-right[

``` r
# çº¿æ€§å›å½’
model.inde &lt;- stats::lm(
  data = df.penguin,
  formula = Temperature ~ 1 + romantic
  )
summary(model.inde)
```

&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/compare1.2.png" width="100%"&gt;
&lt;/p&gt;

]


---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.3 å•æ ·æœ¬*t*æ£€éªŒ(one sample *t*-test)
* ä¾‹å¦‚ï¼šåœ¨penguinæ•°æ®ä¸­ï¼Œå…¨ä½“è¢«è¯•çš„æ ¸å¿ƒä½“æ¸©(Temperature)æ˜¯å¦ç­‰äº36.6ï¼Ÿ&lt;br&gt;
&lt;br&gt;
--
&lt;br&gt;
**æ¯”è¾ƒå•ä¸ªæ ·æœ¬çš„å¹³å‡å€¼(m)ä¸å·²çŸ¥çš„æ€»ä½“å¹³å‡å€¼(Î¼)ä¹‹é—´æ˜¯å¦å­˜åœ¨æ˜¾è‘—å·®å¼‚**&lt;br&gt;
&lt;br&gt;

**å‰ææ¡ä»¶**
* æ­£æ€æ€§ï¼šæ ·æœ¬æ•°æ®åº”æ¥è‡ªæ­£æ€åˆ†å¸ƒçš„æ€»ä½“ã€‚æ ·æœ¬é‡è¶³å¤Ÿå¤§æ—¶ï¼Œå³ä½¿ä¸ä¸¥æ ¼æœä»æ­£æ€åˆ†å¸ƒï¼Œç»“æœä¹Ÿæ˜¯ç¨³å¥çš„ã€‚
* ç‹¬ç«‹æ€§ï¼šæ ·æœ¬ä¸­çš„è§‚æµ‹å€¼å¿…é¡»æ˜¯ç‹¬ç«‹çš„ï¼Œå³ä¸€ä¸ªè§‚æµ‹å€¼ä¸åº”å½±å“å¦ä¸€ä¸ªè§‚æµ‹å€¼ã€‚&lt;br&gt;
&lt;br&gt;

**å‡è®¾**
* `\(H_0\)`: æ ·æœ¬çš„å‡å€¼(m)ä¸ç»™å®šçš„æ€»ä½“å‡å€¼æˆ–å‡è®¾çš„æ€»ä½“å‡å€¼(Î¼)ä¹‹é—´æ²¡æœ‰æ˜¾è‘—å·®å¼‚ã€‚
* `\(H_1\)`: æ ·æœ¬çš„å‡å€¼(m)ä¸ç»™å®šçš„æ€»ä½“å‡å€¼æˆ–å‡è®¾çš„æ€»ä½“å‡å€¼(Î¼)ä¹‹é—´æœ‰æ˜¾è‘—å·®å¼‚ã€‚
&lt;br&gt;

`$$t = \frac{\bar{X} - \mu}{s / \sqrt{n}}$$`

---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.3 å•æ ·æœ¬*t*æ£€éªŒ(one sample *t*-test)
.pull-left[
&lt;br&gt;
&lt;br&gt;

`$$y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \epsilon$$`

å•æ ·æœ¬*t*æ£€éªŒä¸­ï¼Œä»…æˆªè·ä¸ä¸º0ã€‚æ­¤æ—¶å…¬å¼ä¸ºï¼š&lt;br&gt;
--
`$$y = \beta_0$$`
`$$H_0: \beta_0 = 0$$`
]
.pull-right[
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/singlet-lm.png" width="75%"&gt;
&lt;/p&gt;
]
---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.3 å•æ ·æœ¬*t*æ£€éªŒ(one sample *t*-test)

.pull-left[

``` r
stats::t.test(
  x = df.penguin$Temperature, # æ ¸å¿ƒä½“æ¸©å‡å€¼
  mu = 36.6) 
```

&lt;br&gt;
&lt;br&gt;
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/compare2.1.png" width="100%"&gt;
&lt;/p&gt;

]
.pull-right[

``` r
model.single &lt;- lm(
  data = df.penguin,
  formula = Temperature - 36.6 ~ 1
  ) 
summary(model.single) 
```

&lt;br&gt;
&lt;br&gt;
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/compare2.2.png" width="100%"&gt;
&lt;/p&gt;

]

---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.4 é…å¯¹æ ·æœ¬*t*æ£€éªŒ(paired *t*-test)
* ä¾‹å¦‚ï¼Œåœ¨penguinæ•°æ®ä¸­ï¼Œè¢«è¯•æŠ¥å‘Šçš„ä¸¤æ¬¡æ ¸å¿ƒæ¸©åº¦(Temperature_t1, Temperature_t2)æ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚ï¼Ÿ&lt;br&gt;
&lt;br&gt;
--
**æ¯”è¾ƒä¸¤ä¸ªç›¸å…³çš„æ ·æœ¬ç»„ï¼ˆä¾‹å¦‚ï¼ŒåŒä¸€ç»„å—è¯•è€…åœ¨ä¸åŒæ¡ä»¶ä¸‹çš„æµ‹é‡ï¼‰çš„å¹³å‡å€¼æ˜¯å¦å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚**&lt;br&gt;
&lt;br&gt;
**å‰ææ¡ä»¶**
* æ­£æ€æ€§ï¼šæ ·æœ¬æ•°æ®åº”æ¥è‡ªæ­£æ€åˆ†å¸ƒçš„æ€»ä½“ã€‚æ ·æœ¬é‡è¶³å¤Ÿå¤§æ—¶ï¼Œå³ä½¿ä¸ä¸¥æ ¼æœä»æ­£æ€åˆ†å¸ƒï¼Œç»“æœä¹Ÿæ˜¯ç¨³å¥çš„ã€‚
* ç‹¬ç«‹æ€§ï¼šé…å¯¹æ ·æœ¬ä¸­çš„è§‚æµ‹å€¼å¿…é¡»æ˜¯ç‹¬ç«‹çš„ï¼Œå³æ¯ä¸€å¯¹è§‚æµ‹å€¼ä¸åº”å½±å“å…¶ä»–å¯¹çš„è§‚æµ‹å€¼ã€‚
* é…å¯¹è®¾è®¡ï¼šæ•°æ®å¿…é¡»æ˜¯ä»¥é…å¯¹å½¢å¼æ”¶é›†çš„ã€‚&lt;br&gt;
&lt;br&gt;
**å‡è®¾**
* `\(H_0\)`: é…å¯¹æ ·æœ¬çš„æ€»ä½“å¹³å‡å·®ä¸é›¶æ²¡æœ‰æ˜¾è‘—å·®å¼‚ï¼ˆä¸¤ä¸ªé…å¯¹æ ·æœ¬çš„å‡å€¼æ²¡æœ‰æ˜¾è‘—å·®å¼‚ï¼‰ã€‚
* `\(H_1\)`: é…å¯¹æ ·æœ¬çš„æ€»ä½“å¹³å‡å·®ä¸é›¶æœ‰æ˜¾è‘—å·®å¼‚ï¼ˆä¸¤ä¸ªé…å¯¹æ ·æœ¬çš„å‡å€¼å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼‰ã€‚
&lt;br&gt;

`$$t = \frac{\bar{X} - \mu}{s / \sqrt{n}}$$`
---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.4 é…å¯¹æ ·æœ¬*t*æ£€éªŒ(paired *t*-test)

$$y_1 - y_2 = \beta_0 $$
$$H_0: \beta_0 = 0 $$
--
å¯ä»¥å°†é…å¯¹æ ·æœ¬*t*æ£€éªŒç†è§£ä¸ºå¯¹å·®å€¼è¿›è¡Œçš„å•æ ·æœ¬*t*æ£€éªŒï¼Œå³å•ç‹¬ç”¨ä¸€ä¸ªæ•°å­—æ¥é¢„æµ‹å¯¹åº”çš„å·®å€¼ï¼ˆè§å›¾çš„å³åŠéƒ¨åˆ†ï¼‰ã€‚&lt;br&gt;
ä¹Ÿå¯ä»¥è®¤ä¸ºè¿™äº›ç»„é—´ä¹‹å·®æ˜¯æ–œç‡ï¼ˆè§å›¾çš„å·¦åŠéƒ¨åˆ†ï¼‰ã€‚&lt;br&gt;

&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/pairt-lm.png" width="70%"&gt;
&lt;/p&gt;

---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
## 8.1.4 é…å¯¹æ ·æœ¬*t*æ£€éªŒ(paired *t*-test)
.pull-left[


``` r
stats::t.test(
  x = df.penguin$Temperature_t1, 
  y = df.penguin$Temperature_t2, 
  paired = TRUE
  )
```

&lt;br&gt;
&lt;br&gt;
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/compare3.1.png" width="100%"&gt;
&lt;/p&gt;

]
.pull-right[


``` r
model.paired &lt;- lm(
  Temperature_t1 - Temperature_t2 ~ 1,
  data = df.penguin
  )
summary(model.paired)
```

&lt;br&gt;
&lt;br&gt;
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/compare3.2.png" width="100%"&gt;
&lt;/p&gt;

]

---
# 8.1 *t*-test
## 8.1.5 bruceR::TTEST
* å¦‚æœåå¥½æŒ‰ä¼ ç»Ÿæ–¹å¼ä½¿ç”¨*t*æ£€éªŒï¼Œæ¨è`bruceR::TTEST`å‡½æ•°

&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/TTEST.png" width="70%"&gt;
&lt;/p&gt;

ä¸­æ–‡å¸®åŠ©æ–‡æ¡£ï¼šhttps://zhuanlan.zhihu.com/p/281150493
---
# 8.1 *t*-test
## 8.1.5 bruceR::TTEST
.panelset[
.panel[.panel-name[ç‹¬ç«‹æ ·æœ¬tæ£€éªŒ]
.pull-left[


``` r
stats::t.test(
  data = df.penguin, 
  Temperature ~ romantic,
  var.equal = TRUE
  ) 
```


&lt;br&gt;
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/compare1.1.png" width="100%"&gt;
&lt;/p&gt;
]
.pull-right[


``` r
bruceR::TTEST(
  data = df.penguin, # æ•°æ®
  y = "Temperature", # å› å˜é‡
  x = "romantic"     # è‡ªå˜é‡
) 
```

&lt;br&gt;
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/leven.png" width="100%"&gt;
&lt;/p&gt;


]
.panel[.panel-name[å•æ ·æœ¬tæ£€éªŒ]
.pull-left[


``` r
stats::t.test(
  x = df.penguin$Temperature, 
  mu = 36.6
  )
```


&lt;br&gt;
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/compare2.1.png" width="100%"&gt;
&lt;/p&gt;
]
.pull-right[


``` r
bruceR::TTEST(
  data = df.penguin, # æ•°æ®
  y = "Temperature", # ç¡®å®šå˜é‡
  test.value = 36.6, # å›ºå®šå€¼
  test.sided = "=")  # å‡è®¾çš„æ–¹å‘
```

&lt;br&gt;
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/sample.png" width="100%"&gt;
&lt;/p&gt;

]
.panel[.panel-name[é…å¯¹æ ·æœ¬tæ£€éªŒ]

.pull-left[


``` r
stats::t.test(
  x = df.penguin$Temperature_t1, #ç¬¬1æ¬¡
  y = df.penguin$Temperature_t2, #ç¬¬2æ¬¡
  paired = TRUE) 
```


&lt;br&gt;
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/compare3.1.png" width="100%"&gt;
&lt;/p&gt;
]
.pull-right[


``` r
bruceR::TTEST(
  data = df.penguin, # æ•°æ®
  y = c("Temperature_t1",  
        "Temperature_t2"), # å˜é‡ä¸ºä¸¤æ¬¡æ ¸å¿ƒä½“æ¸©
  paired = T)  # é…å¯¹æ•°æ®ï¼Œé»˜è®¤æ˜¯FALSE
```

&lt;br&gt;
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/pair.png" width="100%"&gt;
&lt;/p&gt;
]
]]]]

---
# 8.1 *t*-testç³»åˆ—å‡ä¸ºå›å½’æ¨¡å‹çš„ç‰¹ä¾‹
&lt;br&gt;
&lt;br&gt;

|       | Rè‡ªå¸¦å‡½æ•° | çº¿æ€§æ¨¡å‹ | è§£é‡Š |
|-------|-------|-------|-------|
| å•æ ·æœ¬*t* | t.test(y, mu = 0) | lm(y ~ 1)| ä»…æœ‰æˆªè·çš„å›å½’æ¨¡å‹ |
| ç‹¬ç«‹æ ·æœ¬*t* | t.test(`\(y_1\)`, `\(y_2\)`) | lm(y ~ 1 + `\(G_2\)`)| è‡ªå˜é‡ä¸ºäºŒåˆ†å˜é‡çš„å›å½’æ¨¡å‹ |
| é…å¯¹æ ·æœ¬*t* | t.test(`\(y_1\)`, `\(y_2\)`, paired=T)  | lm(`\(y_1\)` - `\(y_2\)` ~ 1)| ä»…æœ‰æˆªè·çš„å›å½’æ¨¡å‹)|


---
class: center, middle
&lt;span style="font-size: 60px;"&gt;8.2  ANOVA &amp; linear regression&lt;/span&gt; &lt;br&gt;


---
class: left, middle
&lt;span style="font-size: 60px;"&gt;8.2.1  ç ”ç©¶é—®é¢˜&lt;/span&gt; &lt;br&gt;

&lt;br&gt;
&lt;span style="font-size: 35px;"&gt;Q: å¦‚ä½•åŒæ—¶æ¯”è¾ƒä¸åŒèµ¤é“è·ç¦»(DEQ)å’Œä¸åŒæ‹çˆ±çŠ¶æ€(romantic)ä¸‹è¢«è¯•ä½“æ¸©çš„å·®å¼‚&lt;/span&gt; &lt;br&gt;
&lt;br&gt;
&lt;span style="font-size: 40px;"&gt;A: åŒå› ç´ è¢«è¯•é—´æ–¹å·®åˆ†æ&lt;/span&gt; &lt;br&gt;


---
# 8.2  ANOVA &amp; linear regression
## 8.2.2 ä»£ç å®æ“ &amp; çŸ¥è¯†å›é¡¾
.pull-left[
&lt;br&gt;
**æ–¹æ³•ç®€ä»‹ï¼š**

å½“ç ”ç©¶è€…æƒ³è¦æ¯”è¾ƒä¸¤ä¸ªæˆ–å¤šä¸ªç»„ä¹‹é—´çš„å‡å€¼å·®å¼‚æ—¶ï¼Œå¯ä½¿ç”¨æ–¹å·®åˆ†æ(Analysis of Varianceï¼Œç®€ç§°ANOVA)ã€‚&lt;br&gt;
&lt;br&gt;
å®ƒç”±è‹±å›½ç»Ÿè®¡å­¦å®¶R.A.Fisheræå‡ºï¼ŒåŸºæœ¬æ€æƒ³æ˜¯ï¼Œåœ¨**å®éªŒ**ç ”ç©¶ä¸­ï¼Œå°†æµ‹é‡æ•°æ®çš„æ€»å˜å¼‚ï¼ˆå³æ€»æ–¹å·®ï¼‰æŒ‰ç…§å˜å¼‚æ¥æºåˆ†ä¸ºå¤„ç†ï¼ˆç»„é—´ï¼‰æ•ˆåº”å’Œè¯¯å·®ï¼ˆç»„å†…ï¼‰æ•ˆåº”ï¼Œå¹¶ä½œå‡ºå…¶æ•°é‡ä¼°è®¡ï¼Œä»è€Œç¡®å®šå®éªŒå¤„ç†å¯¹ç ”ç©¶ç»“æœå½±å“åŠ›çš„å¤§å°ã€‚

**å‡è®¾ï¼š**
* `\(H_0\)`: å„å› ç´ å„ä¸ªæ°´å¹³ä¸‹ï¼Œå› å˜é‡çš„å‡å€¼å®Œå…¨ç›¸åŒ
* `\(H_1\)`: å„å› ç´ å„ä¸ªæ°´å¹³ä¸‹ï¼Œå› å˜é‡çš„å‡å€¼ä¸å®Œå…¨ç›¸åŒ
]

.pull-right[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
**å‰ææ¡ä»¶ï¼š**

* å¯åŠ æ€§ï¼šå„æ•ˆåº”å¯åŠ ï¼Œå³è§‚æµ‹å€¼æ˜¯ç”±å„ä¸»æ•ˆåº”ï¼Œäº¤äº’ä½œç”¨ä»¥åŠè¯¯å·®é€šè¿‡ç›¸åŠ å¾—åˆ°çš„&lt;br&gt;
* éšæœºæ€§ï¼šå„æ ·æœ¬ï¼ˆè§‚æµ‹å€¼ï¼‰æ˜¯éšæœºæ ·æœ¬&lt;br&gt;
* æ­£æ€æ€§ï¼šå„æ ·æœ¬æ¥è‡ªäºæ­£æ€åˆ†å¸ƒçš„æ€»ä½“&lt;br&gt;
* ç‹¬ç«‹æ€§ï¼šå„æ ·æœ¬è§‚æµ‹å€¼äº’ç›¸ç‹¬ç«‹&lt;br&gt;
* æ–¹å·®é½æ€§ï¼šå„æ ·æœ¬æ¥è‡ªçš„æ€»ä½“æ–¹å·®ç›¸åŒ&lt;br&gt;
* å› å˜é‡åº”ä¸ºè¿ç»­å˜é‡&lt;br&gt;

]

---
# 8.2  ANOVA 
## 8.2.2 ä»£ç å®æ“|æ•°æ®é¢„å¤„ç†
.panelset[
.panel[.panel-name[vars]


``` r
summary(df.penguin$DEQ)
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.293  34.433  39.912  39.842  51.317  60.391
```


``` r
# è®¾å®šåˆ†å‰²ç‚¹
# [0-23.5 çƒ­å¸¦ï¼Œ 23.5-35 äºšçƒ­å¸¦]ï¼Œ [35-40 æš–æ¸©å¸¦ï¼Œ 40-50 ä¸­æ¸©å¸¦]ï¼Œ [50-66.5 å¯’æ¸©å¸¦]
breaks &lt;- c(0, 35, 50, 66.5)

# è®¾å®šç›¸åº”çš„æ ‡ç­¾
labels &lt;- c('çƒ­å¸¦', 'æ¸©å¸¦', 'å¯’æ¸©å¸¦')

# åˆ›å»ºæ–°çš„å˜é‡
df.penguin$climate &lt;- cut(df.penguin$DEQ, 
                          breaks = breaks, 
                          labels = labels)
summary(df.penguin$climate)
```

```
##   çƒ­å¸¦   æ¸©å¸¦ å¯’æ¸©å¸¦ 
##    396    592    439
```

.panel[.panel-name[tidy data]


``` r
df &lt;- df.penguin %&gt;% 
  select(subjID, climate, romantic, Temperature) 
```

<div class="datatables html-widget html-fill-item" id="htmlwidget-894aa7e22f084772f0d9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-894aa7e22f084772f0d9">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6"],[1,2,3,4,5,6],["çƒ­å¸¦","å¯’æ¸©å¸¦","å¯’æ¸©å¸¦","å¯’æ¸©å¸¦","æ¸©å¸¦","å¯’æ¸©å¸¦"],["å•èº«","æ‹çˆ±","æ‹çˆ±","æ‹çˆ±","æ‹çˆ±","æ‹çˆ±"],[36.75,35.40000000000001,35.1,35.95,36.08333333,35.59999999999999]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>subjID<\/th>\n      <th>climate<\/th>\n      <th>romantic<\/th>\n      <th>Temperature<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"subjID","targets":1},{"name":"climate","targets":2},{"name":"romantic","targets":3},{"name":"Temperature","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

]]]


---
# 8.2  ANOVA &amp; linear regression
## 8.2.2 ä»£ç å®æ“|æ­£æ€æ€§æ£€éªŒ
.panelset[
.panel[.panel-name[KSæ£€éªŒ]


``` r
# æ­£æ€æ€§æ£€éªŒ-Kolmogorov-Smirnovæ£€éªŒ
# è‹¥p &gt;.05ï¼Œä¸èƒ½æ‹’ç»æ•°æ®ç¬¦åˆæ­£æ€åˆ†å¸ƒçš„é›¶å‡è®¾
ks.test(df$Temperature, 'pnorm')
```

```
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  df$Temperature
## D = 1, p-value &lt; 0.00000000000000022
## alternative hypothesis: two-sided
```


``` r
# è¿›è¡Œæ•°æ®è½¬æ¢ï¼Œè½¬æ¢åä»éæ­£æ€åˆ†å¸ƒ
df$Temperature_log &lt;- log(df$Temperature)
ks.test(df$Temperature_log, 'pnorm')
```

```
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  df$Temperature_log
## D = 0.99981, p-value &lt; 0.00000000000000022
## alternative hypothesis: two-sided
```

.panel[.panel-name[qqå›¾]

``` r
# æ­£æ€æ€§æ£€éªŒ-qqå›¾
qqnorm(df$Temperature)
qqline(df$Temperature, col = "red") # æ·»åŠ ç†è®ºæ­£æ€åˆ†å¸ƒçº¿
```

![](chapter_9_files/figure-html/unnamed-chunk-21-1.png)&lt;!-- --&gt;

.panel[.panel-name[ç›´æ–¹å›¾]

``` r
ggplot(df, aes(Temperature)) +
    geom_histogram(aes(y =..density..), color='black', fill='white', bins=30) +
    geom_density(alpha=.5, fill='red')
```

![](chapter_9_files/figure-html/unnamed-chunk-22-1.png)&lt;!-- --&gt;

]]]]


---
# 8.2  ANOVA &amp; linear regression
## 8.2.2 ä»£ç å®æ“|åŒå› ç´ è¢«è¯•é—´æ–¹å·®åˆ†æ
.panelset[
.panel[.panel-name[stats::aov()]


``` r
aov1 &lt;- stats::aov(Temperature ~ climate * romantic, data = df)
summary(aov1)
```

```
##                    Df Sum Sq Mean Sq F value               Pr(&gt;F)    
## climate             2  18.82   9.408  49.392 &lt; 0.0000000000000002 ***
## romantic            1   0.24   0.244   1.280              0.25807    
## climate:romantic    2   1.91   0.955   5.014              0.00676 ** 
## Residuals        1421 270.65   0.190                                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

.panel[.panel-name[SPSS]
&lt;img src="picture/chp8/SPSS.png" width="1627" /&gt;

]]]


---
class: center, middle
&lt;span style="font-size: 60px;"&gt;ç»“æœä¸ºä»€ä¹ˆä¸ç›¸åŒï¼Ÿ&lt;/span&gt; &lt;br&gt;


---
# 8.2  ANOVA &amp; linear regression
## 8.2.2 ä»£ç å®æ“|å¹³æ–¹å’Œ(SS)çš„è®¡ç®—
&lt;br&gt;
åœ¨å¹³è¡¡è®¾è®¡ä¸­ï¼Œä¸‰ç§ç±»å‹çš„å¹³æ–¹å’Œçš„ç»“æœä¼šå¾ˆæ¸…æ™°ï¼Œå¹¶ä¸”æ–¹å·®åˆ†æçš„ç»“æœç‹¬ç«‹äºå¹³æ–¹å’Œçš„ç±»å‹ï¼›&lt;br&gt;
è€Œåœ¨éå¹³è¡¡è®¾è®¡ä¸­ï¼Œå°¤å…¶æ˜¯å½“å„ç»„æ ·æœ¬é‡å·®è·è¾ƒå¤§æ—¶ï¼Œä¸‰ç§ç±»å‹çš„å¹³æ–¹å’Œè®¡ç®—ç»“æœå¯èƒ½ä¼šä¸åŒï¼Œæ­¤æ—¶éœ€è¦æ ¹æ®å…·ä½“ç ”ç©¶è®¾è®¡å’Œé—®é¢˜æ¥é€‰æ‹©ä½¿ç”¨å“ªä¸€ç§ç±»å‹çš„å¹³æ–¹å’Œã€‚&lt;br&gt;
&lt;br&gt;
å¯¹äº Y ~ A + B + A * B&lt;br&gt;
&lt;br&gt;
.panelset[
.panel[.panel-name[Type I SS]
&lt;br&gt;
è§£é‡Šå˜é‡çš„é¡ºåºä¼šå½±å“åˆ°ç±»å‹Iå¹³æ–¹å’Œçš„è®¡ç®—ç»“æœï¼Œé€šå¸¸ç”¨äºé¡ºåºé‡è¦çš„æ¨¡å‹ã€‚&lt;br&gt;
æ•ˆåº”æ ¹æ®è¡¨è¾¾å¼ä¸­å…ˆå‡ºç°çš„æ•ˆåº”åšè°ƒæ•´ã€‚Aä¸åšè°ƒæ•´ï¼ŒBæ ¹æ®Aè°ƒæ•´ï¼ŒA:Bäº¤äº’é¡¹æ ¹æ®Aå’ŒBè°ƒæ•´ã€‚&lt;br&gt;
&lt;br&gt;
**stats::aov()å‡½æ•°é»˜è®¤é‡‡ç”¨çš„å°±æ˜¯Type I SSï¼Œå®ƒé€æ­¥å°†æ¯ä¸€ä¸ªå› å­å¼•å…¥æ¨¡å‹è¿›è¡Œè®¡ç®—ã€‚**&lt;br&gt;

.panel[.panel-name[Type II SS]
&lt;br&gt;
å¿½ç•¥äº†å› å­ä¹‹é—´å¯èƒ½å­˜åœ¨çš„äº¤äº’ä½œç”¨ï¼Œé€‚ç”¨äºæ‰€æœ‰ä¸»æ•ˆåº”ä¸æ¶‰åŠäº¤äº’æ•ˆåº”çš„æƒ…å†µã€‚&lt;br&gt;
å‡å®šæ‰€æœ‰çš„å› å­éƒ½æ˜¯åŒæ—¶è¿›å…¥æ¨¡å‹çš„ï¼Œå¹¶ä¸”å®ƒä»¬éƒ½æ˜¯ç­‰ä»·çš„ã€‚&lt;br&gt;
æ•ˆåº”æ ¹æ®åŒæ°´å¹³æˆ–ä½æ°´å¹³çš„æ•ˆåº”åšè°ƒæ•´ã€‚Aæ ¹æ®Bè°ƒæ•´ï¼ŒBä¾æ®Aè°ƒæ•´ï¼ŒA:Bäº¤äº’é¡¹åŒæ—¶æ ¹æ®Aå’ŒBè°ƒæ•´ã€‚&lt;br&gt;
&lt;br&gt;
**car::Anova()å‡½æ•°é»˜è®¤è®¡ç®—Type II SSï¼Œå¯ä»¥é€šè¿‡type = 3è°ƒæ•´ä¸ºType III SSã€‚**&lt;br&gt;

.panel[.panel-name[Type III SS]
&lt;br&gt;
æ›´å…¨é¢ï¼Œå‡å®šæ‰€æœ‰å› å­ï¼ˆä»¥åŠå®ƒä»¬çš„äº¤äº’é¡¹ï¼‰éƒ½æ˜¯é‡è¦çš„ï¼Œå¹¶è€ƒè™‘æ‰€æœ‰å› ç´ ã€‚&lt;br&gt;
æ¯ä¸ªæ•ˆåº”æ ¹æ®æ¨¡å‹å…¶ä»–å„æ•ˆåº”åšç›¸åº”è°ƒæ•´ã€‚Aæ ¹æ®Bå’ŒA:Båšè°ƒæ•´ï¼ŒA:Bäº¤äº’é¡¹æ ¹æ®Aå’ŒBè°ƒæ•´ã€‚&lt;br&gt;
&lt;br&gt;
**SPSSé»˜è®¤é‡‡ç”¨Type III SSã€‚**&lt;br&gt;
**bruceR::MANOVA*()å‡½æ•°ä¹Ÿé»˜è®¤é‡‡ç”¨Type III SSï¼Œå¯ä»¥é€šè¿‡ss.type = 2è°ƒæ•´ä¸ºType II SSã€‚**&lt;br&gt;

]]]]




---
# 8.2  ANOVA &amp; linear regression
## 8.2.2 ä»£ç å®æ“|åŒå› ç´ è¢«è¯•é—´æ–¹å·®åˆ†æ
.panelset[
.panel[.panel-name[car::Anova()]

``` r
# ç»“æœä¸ä¸€è‡´ï¼ŒåŸå› PPTæ˜¾ç¤ºä¸å…¨ï¼Œè¯·å›åˆ°rmdæ–‡æ¡£æŸ¥çœ‹
aov1 &lt;- car::Anova(stats::aov(Temperature ~ climate * romantic, data = df))
aov1
```

```
## Anova Table (Type II tests)
## 
## Response: Temperature
##                   Sum Sq   Df F value                Pr(&gt;F)    
## climate           19.034    2 49.9680 &lt; 0.00000000000000022 ***
## romantic           0.244    1  1.2801              0.258072    
## climate:romantic   1.910    2  5.0136              0.006765 ** 
## Residuals        270.654 1421                                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```


``` r
# åŸå› debug
# æŸ¥çœ‹Rçš„é»˜è®¤å¯¹æ¯”è®¾ç½®
options("contrasts")
```

```
## $contrasts
##         unordered           ordered 
## "contr.treatment"      "contr.poly"
```

``` r
# ä»è¾“å‡ºç»“æœå¯çŸ¥ï¼Œæ— åºé»˜è®¤ä¸ºcontr.treatment()ï¼Œæœ‰åºé»˜è®¤ä¸ºcontr.poly()
# factor()å‡½æ•°æ¥åˆ›å»ºæ— åºå› å­ï¼Œordered()å‡½æ•°åˆ›å»ºæœ‰åºå› å­

is.factor(df$climate)
```

```
## [1] TRUE
```

``` r
is.ordered(df$climate)
```

```
## [1] FALSE
```

``` r
# climateæ˜¯æ— åºå› å­

# åˆ›å»ºä¸€ä¸ª3æ°´å¹³çš„å› å­çš„åŸºå‡†å¯¹æ¯”
c1 &lt;- contr.treatment(3)

# åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹æ¯”ï¼Œè¿™ä¸ªç¼–ç å‡è®¾åˆ†ç±»æ°´å¹³ä¹‹é—´çš„å·®å¼‚è¢«ç­‰åˆ†ï¼Œæ¯ä¸€ä¸ªæ°´å¹³ä¸æ€»å‡å€¼çš„å·®å¼‚ç­‰äº1/3
my.coding &lt;- matrix(rep(1/3, 6), ncol=2)
# å°†å¯¹æ¯”è°ƒæ•´ä¸ºæ¯ä¸ªæ°´å¹³ä¸ç¬¬ä¸€ä¸ªæ°´å¹³çš„æŒ¯å¹…å‡å»1/3
# å¯èƒ½çš„åŸå› ï¼šé™¤äº†å…³å¿ƒæ¯ä¸ªæ°´å¹³å¯¹åº”çš„æ•ˆæœï¼ŒåŒæ—¶ä¹Ÿå…³å¿ƒæ°´å¹³ä¸æ°´å¹³ä¹‹é—´çš„æ•ˆæœ
my.simple &lt;- c1-my.coding
my.simple
```

```
##            2          3
## 1 -0.3333333 -0.3333333
## 2  0.6666667 -0.3333333
## 3 -0.3333333  0.6666667
```

``` r
# æ›´æ”¹climateçš„å¯¹æ¯”
contrasts(df$climate) &lt;- my.simple

# å°†æ•°æ®é›†dfçš„romanticåˆ—çš„å¯¹æ¯”è®¾ä¸ºç­‰è·å¯¹æ¯”ï¼Œå®ƒå‡è®¾åˆ†ç±»æ°´å¹³ä¹‹é—´çš„å·®å¼‚ä¸ºç­‰è·ç¦»
contrasts(df$romantic) &lt;- contr.sum(2)/2

# æ–¹å·®åˆ†æ
aov1 &lt;- car::Anova(lm(Temperature ~ climate * romantic, data = df),
                   type = 3)
aov1
```

```
## Anova Table (Type III tests)
## 
## Response: Temperature
##                   Sum Sq   Df      F value                Pr(&gt;F)    
## (Intercept)      1768309    1 9284069.6498 &lt; 0.00000000000000022 ***
## climate               19    2      50.8832 &lt; 0.00000000000000022 ***
## romantic               0    1       1.0006              0.317336    
## climate:romantic       2    2       5.0136              0.006765 ** 
## Residuals            271 1421                                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

.panel[.panel-name[afex::aov_ez()]

``` r
afex::aov_ez(id = "subjID", 
             dv = "Temperature", 
             data = df, 
             between = c("climate", "romantic"), 
             type = 3)
```

```
## Anova Table (Type 3 tests)
## 
## Response: Temperature
##             Effect      df  MSE         F   ges p.value
## 1          climate 2, 1421 0.19 50.88 ***  .067   &lt;.001
## 2         romantic 1, 1421 0.19      1.00 &lt;.001    .317
## 3 climate:romantic 2, 1421 0.19   5.01 **  .007    .007
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1
```


``` r
# afexä¸­çš„å…¶ä»–å‡½æ•°å¯ä»¥å¾—åˆ°åŒæ ·çš„ç»“æœ
afex::aov_car(Temperature ~ climate * romantic + Error(subjID), data = df, type = 3)
afex::aov_4(Temperature ~ climate * romantic + (1|subjID), data = df)
```


]]]

---
# 8.2  ANOVA &amp; linear regression
## 8.2.3 çº¿æ€§å›å½’

.pull-left[

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
è¿™é‡Œçš„ANOVAä»ç„¶æ˜¯çº¿æ€§å›å½’æ¨¡å‹çš„ç‰¹ä¾‹ï¼Œå³è‡ªå˜é‡æ˜¯ç¦»æ•£å˜é‡çš„æƒ…å†µã€‚
&lt;br&gt;
å¦‚æœä½¿ç”¨å“‘å˜é‡ï¼ˆdummy codingï¼‰å¯¹è‡ªå˜é‡è¿›è¡Œç¼–ç åè¿›å…¥å›å½’æ–¹ç¨‹ï¼Œçº¿æ€§æ¨¡å‹ä¸­çš„æ–œç‡å³æ˜¯å¯¹ç»„é—´å·®å¼‚çš„ä¼°è®¡ã€‚&lt;br&gt;
&lt;br&gt;
**åŒå› ç´ æ–¹å·®åˆ†æå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§å›å½’æ¨¡å‹ï¼Œè‡ªå˜é‡ä¸ºä¸¤ä¸ªåˆ†ç±»å˜é‡ã€‚**&lt;br&gt;

]

.pull-right[
&lt;br&gt;
&lt;br&gt;
&lt;img src="picture/chp8/aovLM.png" width="1765" /&gt;
]

---
# 8.2  ANOVA &amp; linear regression
## 8.2.3 çº¿æ€§å›å½’
.pull-left[


``` r
aov1 &lt;- car::Anova(
  aov(Temperature ~ climate * romantic, 
      data = df), 
  type = 3
  )
aov1
```
&lt;br&gt;
![](./picture/chp8/compare8231.png)
]



.pull-right[


``` r
lm1 &lt;- car::Anova(
  lm(Temperature ~ climate * romantic, 
     data = df), 
  type = 3
  )
lm1
```
&lt;br&gt;
![](./picture/chp8/compare8232.png)

]


---
# 8.2  ANOVA &amp; linear regression
## 8.2.2 ä»£ç å®æ“: `bruceR`
* ä½¿ç”¨`bruceR`å¯ä»¥æ›´ç®€å•åœ°å®ç°å¿ƒç†å­¦ä¸­ä¹ æƒ¯çš„ANOVAï¼Œä½†è¦æ³¨æ„æ•°æ®æ ¼å¼
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/ANOVA data.png" width="65%"&gt;
&lt;/p&gt;


---
# 8.2  ANOVA &amp; linear regression
## 8.2.2 ä»£ç å®æ“: `bruceR::MANOVA`
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/MANOVA.png" width="70%"&gt;
&lt;/p&gt;


---
# 8.2  ANOVA &amp; linear regression
## 8.2.2 ä»£ç å®æ“: `bruceR::MANOVA`

``` r
res1 &lt;- bruceR::MANOVA(data = df, 
                       dv = "Temperature", 
                       between = c("climate", "romantic"))
```

```
## [1] "Anova Table (Type III tests)"                                  
## [2] ""                                                              
## [3] "Response: Temperature"                                         
## [4] "            Effect      df  MSE         F   ges p.value"       
## [5] "1          climate 2, 1421 0.19 50.88 ***  .067   &lt;.001"       
## [6] "2         romantic 1, 1421 0.19      1.00 &lt;.001    .317"       
## [7] "3 climate:romantic 2, 1421 0.19   5.01 **  .007    .007"       
## [8] "---"                                                           
## [9] "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1"
```


---
# 8.2  ANOVA &amp; linear regression
## 8.2.2 ä»£ç å®æ“: `bruceR::EMMEANS`
æ›´è¿›ä¸€æ­¥è¿›è¡Œç®€å•æ•ˆåº”åˆ†æä¸å¤šé‡æ¯”è¾ƒ
&lt;p align="center"&gt;
  &lt;img src="./picture/chp8/EMMEANS.png" width="70%"&gt;
&lt;/p&gt;


---
# 8.2  ANOVA &amp; linear regression
## 8.2.2 ä»£ç å®æ“: `bruceR::EMMEANS`

``` r
sim_eff &lt;- res1 %&gt;% 
  bruceR::EMMEANS("climate", by = "romantic") %&gt;%
  bruceR::EMMEANS("romantic", by = "climate")
```

------ EMMEANS (effect = "climate") ------

Joint Tests of "climate":
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Effect "romantic" df1  df2      F     p     Î·Â²p [90% CI of Î·Â²p]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 climate       æ‹çˆ±   2 1421 13.165 &lt;.001 ***   .018 [.008, .031]
 climate       å•èº«   2 1421 41.817 &lt;.001 ***   .056 [.037, .075]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Note. Simple effects of repeated measures with 3 or more levels
are different from the results obtained with SPSS MANOVA syntax.

Estimated Marginal Means of "climate":
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 "climate" "romantic"   Mean [95% CI of Mean]    S.E.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      çƒ­å¸¦       æ‹çˆ± 36.510 [36.446, 36.575] (0.033)
      æ¸©å¸¦       æ‹çˆ± 36.393 [36.346, 36.440] (0.024)
    å¯’æ¸©å¸¦       æ‹çˆ± 36.296 [36.245, 36.347] (0.026)
      çƒ­å¸¦       å•èº« 36.590 [36.532, 36.648] (0.029)
      æ¸©å¸¦       å•èº« 36.356 [36.303, 36.409] (0.027)
    å¯’æ¸©å¸¦       å•èº« 36.182 [36.114, 36.250] (0.035)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Pairwise Comparisons of "climate":
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      Contrast "romantic" Estimate    S.E.   df      t     p     Cohenâ€™s d [95% CI of d]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   æ¸©å¸¦ - çƒ­å¸¦       æ‹çˆ±   -0.117 (0.041) 1421 -2.879  .012 *   -0.268 [-0.491, -0.045]
 å¯’æ¸©å¸¦ - çƒ­å¸¦       æ‹çˆ±   -0.214 (0.042) 1421 -5.111 &lt;.001 *** -0.490 [-0.720, -0.260]
 å¯’æ¸©å¸¦ - æ¸©å¸¦       æ‹çˆ±   -0.097 (0.035) 1421 -2.741  .019 *   -0.222 [-0.417, -0.028]
   æ¸©å¸¦ - çƒ­å¸¦       å•èº«   -0.234 (0.040) 1421 -5.853 &lt;.001 *** -0.536 [-0.756, -0.317]
 å¯’æ¸©å¸¦ - çƒ­å¸¦       å•èº«   -0.409 (0.046) 1421 -8.969 &lt;.001 *** -0.936 [-1.186, -0.686]
 å¯’æ¸©å¸¦ - æ¸©å¸¦       å•èº«   -0.174 (0.044) 1421 -3.966 &lt;.001 *** -0.400 [-0.641, -0.158]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Pooled SD for computing Cohenâ€™s d: 0.436
P-value adjustment: Bonferroni method for 3 tests.

Disclaimer:
By default, pooled SD is Root Mean Square Error (RMSE).
There is much disagreement on how to compute Cohenâ€™s d.
You are completely responsible for setting `sd.pooled`.
You might also use `effectsize::t_to_d()` to compute d.

------ EMMEANS (effect = "romantic") ------

Joint Tests of "romantic":
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Effect "climate" df1  df2     F     p     Î·Â²p [90% CI of Î·Â²p]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 romantic      çƒ­å¸¦   1 1421 3.287  .070 .     .002 [.000, .008]
 romantic      æ¸©å¸¦   1 1421 1.055  .305       .001 [.000, .005]
 romantic    å¯’æ¸©å¸¦   1 1421 6.966  .008 **    .005 [.001, .013]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Note. Simple effects of repeated measures with 3 or more levels
are different from the results obtained with SPSS MANOVA syntax.

Estimated Marginal Means of "romantic":
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 "romantic" "climate"   Mean [95% CI of Mean]    S.E.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       æ‹çˆ±      çƒ­å¸¦ 36.510 [36.446, 36.575] (0.033)
       å•èº«      çƒ­å¸¦ 36.590 [36.532, 36.648] (0.029)
       æ‹çˆ±      æ¸©å¸¦ 36.393 [36.346, 36.440] (0.024)
       å•èº«      æ¸©å¸¦ 36.356 [36.303, 36.409] (0.027)
       æ‹çˆ±    å¯’æ¸©å¸¦ 36.296 [36.245, 36.347] (0.026)
       å•èº«    å¯’æ¸©å¸¦ 36.182 [36.114, 36.250] (0.035)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Pairwise Comparisons of "romantic":
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    Contrast "climate" Estimate    S.E.   df      t     p     Cohenâ€™s d [95% CI of d]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 å•èº« - æ‹çˆ±      çƒ­å¸¦    0.080 (0.044) 1421  1.813  .070 .    0.183 [-0.015,  0.382]
 å•èº« - æ‹çˆ±      æ¸©å¸¦   -0.037 (0.036) 1421 -1.027  .305     -0.085 [-0.247,  0.077]
 å•èº« - æ‹çˆ±    å¯’æ¸©å¸¦   -0.115 (0.043) 1421 -2.639  .008 **  -0.262 [-0.458, -0.067]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Pooled SD for computing Cohenâ€™s d: 0.436
No need to adjust p values.

Disclaimer:
By default, pooled SD is Root Mean Square Error (RMSE).
There is much disagreement on how to compute Cohenâ€™s d.
You are completely responsible for setting `sd.pooled`.
You might also use `effectsize::t_to_d()` to compute d.

---
# 8.2  ANOVA &amp; linear regression
## 8.2.4 çŸ¥è¯†å»¶ç”³|å•å› ç´ æ–¹å·®åˆ†æç¤ºä¾‹

``` r
# DEQå¯¹Temperatureçš„å½±å“
res2 &lt;- bruceR::MANOVA(
  data = df,
  dv = "Temperature",
  between = "climate") 
```

```
## 
## ====== ANOVA (Between-Subjects Design) ======
## 
## Descriptives:
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
##  "climate"   Mean    S.D.   n
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
##       çƒ­å¸¦ 36.555 (0.411) 396
##       æ¸©å¸¦ 36.377 (0.401) 592
##     å¯’æ¸©å¸¦ 36.255 (0.504) 439
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## Total sample size: N = 1427
## 
## ANOVA Table:
## Dependent variable(s):      Temperature
## Between-subjects factor(s): climate
## Within-subjects factor(s):  â€“
## Covariate(s):               â€“
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
##             MS   MSE df1  df2      F     p     Î·Â²p [90% CI of Î·Â²p]  Î·Â²G
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## climate  9.408 0.192   2 1424 49.106 &lt;.001 ***   .065 [.045, .085] .065
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## MSE = mean square error (the residual variance of the linear model)
## Î·Â²p = partial eta-squared = SS / (SS + SSE) = F * df1 / (F * df1 + df2)
## Ï‰Â²p = partial omega-squared = (F - 1) * df1 / (F * df1 + df2 + 1)
## Î·Â²G = generalized eta-squared (see Olejnik &amp; Algina, 2003)
## Cohenâ€™s fÂ² = Î·Â²p / (1 - Î·Â²p)
## 
## Leveneâ€™s Test for Homogeneity of Variance:
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
##                  Leveneâ€™s F df1  df2     p    
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## DV: Temperature      18.207   2 1424 &lt;.001 ***
## â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```


---
# 8.2  ANOVA &amp; linear regression
## 8.2.4 çŸ¥è¯†å»¶ç”³|æ€»ç»“
&lt;br&gt;
&lt;br&gt;

|       | Rè‡ªå¸¦å‡½æ•° | çº¿æ€§æ¨¡å‹ | è§£é‡Š |
|-------|-------|-------|-------|
| å•å› ç´ ANOVA | aov(y ~ G) | lm(y ~ 1 + `\(G_1\)` + `\(G_2\)` + ...)| ä¸€ä¸ªç¦»æ•£è‡ªå˜é‡çš„å›å½’æ¨¡å‹ |
| å¤šå› ç´ ANOVA | aovt(y ~ G * S) | lm(y ~ `\(G_1\)` + `\(G_2\)` + ... + `\(S_1\)` + `\(S_2\)` + ...)| å¤šä¸ªç¦»æ•£è‡ªå˜é‡çš„å›å½’æ¨¡å‹ |


---
&lt;h1 lang="zh-CN" style="font-size: 60px;"&gt;è¯¾å ‚æ€»ç»“&lt;/h1&gt;

![](./picture/chp8/route.png)


---
&lt;h1 lang="zh-CN" style="font-size: 60px;"&gt;è¯¾å ‚æ€»ç»“&lt;/h1&gt;

|       | Rè‡ªå¸¦å‡½æ•° | çº¿æ€§æ¨¡å‹ | è§£é‡Š |
|-------|-------|-------|-------|
| å•æ ·æœ¬*t* | t.test(y, mu = 0) | lm(y ~ 1)| ä»…æœ‰æˆªè·çš„å›å½’æ¨¡å‹ |
| ç‹¬ç«‹æ ·æœ¬*t* | t.test(`\(y_1\)`, `\(y_2\)`) | lm(y ~ 1 + `\(G_2\)`)| è‡ªå˜é‡ä¸ºäºŒåˆ†å˜é‡çš„å›å½’æ¨¡å‹ |
| é…å¯¹æ ·æœ¬*t* | t.test(`\(y_1\)`, `\(y_2\)`, paired=T)  | lm(`\(y_1\)` - `\(y_2\)` ~ 1)| ä»…æœ‰æˆªè·çš„å›å½’æ¨¡å‹)|
| å•å› ç´ ANOVA | aov(y ~ G) | lm(y ~ 1 + `\(G_1\)` + `\(G_2\)` + ...)| ä¸€ä¸ªç¦»æ•£è‡ªå˜é‡çš„å›å½’æ¨¡å‹ |
| å¤šå› ç´ ANOVA | aovt(y ~ G * S) | lm(y ~ `\(G_1\)` + `\(G_2\)` + ... + `\(S_1\)` + `\(S_2\)` + ...)| å¤šä¸ªç¦»æ•£è‡ªå˜é‡çš„å›å½’æ¨¡å‹ |

å‚è€ƒï¼šhttps://lindeloev.github.io/tests-as-linear/#61_one-way_anova_and_kruskal-wallis


---
class: center, middle
&lt;span style="font-size: 60px;"&gt;æ€è€ƒ&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 55px;"&gt;å¦‚ä½•ä»å›å½’æ¨¡å‹çš„è§’åº¦ç†è§£é‡å¤æµ‹é‡æ–¹å·®åˆ†æå‘¢ï¼Ÿ&lt;/span&gt; &lt;br&gt;


---
&lt;h1 lang="zh-CN" style="font-size: 60px;"&gt;è¯¾å ‚ç»ƒä¹ &lt;/h1&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 lang="zh-CN"&gt;1. åœ¨Penguinæ•°æ®ä¸­ï¼Œå¤„åœ¨ä¸åŒæ‹çˆ±çŠ¶æ€ä¸‹(romantic)çš„è¢«è¯•åœ¨ç¤¾äº¤å¤æ‚åº¦(socialdiversity)ä¸Šæ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚ï¼Ÿ&lt;/h2&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2 lang="zh-CN"&gt;2. åœ¨Penguinæ•°æ®ä¸­ï¼Œä¸åŒæ°”å€™å¸¦(DEQ)ä¸æ‹çˆ±çŠ¶æ€(romantic)å¯¹è¢«è¯•ç¤¾äº¤å¤æ‚åº¦(socialdiversity)çš„å½±å“.&lt;/h2&gt;


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLines": true,
"highlightStyle": "github",
"countIncrementalSlides": false,
"seal": true,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
