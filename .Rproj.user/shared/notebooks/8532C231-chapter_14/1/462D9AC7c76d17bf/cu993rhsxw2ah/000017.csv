"0","#| code-fold: true    #指示折叠或展开代码"
"0","#| code-summary: ""expand for full code""    #代码块说明文字"
"0","#| fig-align: ""center""      #设置图形居中显示"
"0",""
"0","# Bootstrap抽样函数,抽取50个子样本"
"0","bootstrap_sample <- function(data, size=50) {"
"0","  n <- nrow(data)"
"0","  indices <- sample(1:n, replace = TRUE, size = size)"
"0","  bootstrap_sample <- data[indices, ]"
"0","  return(bootstrap_sample)"
"0","}"
"0",""
"0","# 重复抽样3次"
"0","k <- 30"
"0",""
"0","# 存储统计量和回归模型"
"0","statistics_beta <- numeric(k)"
"0","statistics_R2 <- numeric(k)"
"0","models <- list()"
"0",""
"0","# 进行bootstrap抽样、计算统计量、绘制散点图和拟合直线"
"0","for (i in 1:k) {"
"0","  #抽样"
"0","  bootstrap_sample_data <- bootstrap_sample(data,size=50)"
"0","  "
"0","  # 计算统计量 beta 和 R^2"
"0","  x <- bootstrap_sample_data$Exam"
"0","  y <- bootstrap_sample_data$Anxiety"
"0","  model <- lm(y ~ x)"
"0","  beta <- coef(model)[2]"
"0","  R2 <- summary(model)$r.squared"
"0","  "
"0","  # 存储统计量和回归模型"
"0","  statistics_beta[i] <- beta"
"0","  statistics_R2[i] <- R2"
"0","  models[[i]] <- model"
"0","  "
"0","  # 绘制散点图和拟合直线"
"0","  p <- ggplot(bootstrap_sample_data, aes(x = Exam, y = Anxiety)) +"
"0","    geom_point() +"
"0","    geom_smooth(method = ""lm"", se = FALSE, color = ""red"", linetype = ""solid"", size = 2) +"
"0","    labs(title = paste(""Bootstrap Sample"", i), x = ""Exam"", y = ""Anxiety"") +"
"0","    annotate(""text"", x = Inf, y = Inf, label = paste(""β ="", round(beta, 3), ""\nR^2 ="", round(R2, 3)),"
"0","             hjust = 1, vjust = 1, size = 4, color = ""black"") +"
"0","    papaja::theme_apa()  # "
"0","  "
"0","  print(p)"
"0","}"
