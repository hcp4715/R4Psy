"0","#| code-fold: true    #指示折叠或展开代码"
"0","#| code-summary: ""expand for full code""    #代码块说明文字"
"0","#| fig-align: ""center""      #设置图形居中显示"
"0",""
"0","# 定义Cohen's d的统计量函数"
"0","bootstrap_cohens_d <- function(data, indices) {"
"0","  sampled_data <- data[indices, ]"
"0","  "
"0","  group_A <- subset(sampled_data, Anxiety_1 == ""high"")$Exam"
"0","  group_B <- subset(sampled_data, Anxiety_1 == ""low"")$Exam"
"0","  "
"0","  mean_A <- mean(group_A)"
"0","  mean_B <- mean(group_B)"
"0","  "
"0","  SS_A <- sum((group_A - mean_A)^2)"
"0","  SS_B <- sum((group_B - mean_B)^2)"
"0","  "
"0","  n_A <- length(group_A)"
"0","  n_B <- length(group_B)"
"0","  "
"0","  cohen.d <- (mean_A - mean_B) / sqrt((SS_A + SS_B) / (n_A + n_B - 2))"
"0","  return(cohen.d)"
"0","}"
"0",""
"0","# 进行1500次Bootstrap"
"0","bootstrap_results <- boot(data = data, statistic = bootstrap_cohens_d, R = 1500)"
"0",""
"0","# 绘制Cohen's d的直方图"
"0","hist(bootstrap_results$t, main = ""Bootstrap Distribution of Cohen's d"","
"0","     xlab = ""Cohen's d"", ylab = ""Density"", "", col = 'grey"", freq = FALSE, breaks = 100)"
